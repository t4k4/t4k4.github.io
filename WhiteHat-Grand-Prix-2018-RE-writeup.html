<!DOCTYPE html>
<html ⚡ lang="en">
  <head>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700|Lora:400,700' rel='stylesheet' type='text/css'>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <link rel="shortcut icon" href="https://t4k4.github.io//assets/images/Image_213449.jpg" type="image/png" />

  <title>WhiteHat 2018 WP</title>

  <meta name="description" content="re01">

  <meta property="og:site_name" content="TAKA" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="WhiteHat 2018 WP" />
  <meta property="og:description" content="Just wish me a brand new start of the next few years." />
  <meta property="og:url" content="https://t4k4.github.io//WhiteHat-Grand-Prix-2018-RE-writeup" />
  <meta property="og:image" content="https://t4k4.github.io//assets/images/radhakrishna.jpg" />
  <meta property="article:publisher" content="https://www.facebook.com/facebook" />
  <meta property="article:tag" content="CTF" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="WhiteHat 2018 WP" />
  <meta name="twitter:description" content="Just wish me a brand new start of the next few years." />
  <meta name="twitter:url" content="https://t4k4.github.io//" />
  <meta name="twitter:image" content="https://t4k4.github.io//assets/images/radhakrishna.jpg" />
  <meta name="twitter:label1" content="Written by" />
  <meta name="twitter:data1" content="TAKA" />
  <meta name="twitter:label2" content="Filed under" />
  <meta name="twitter:data2" content="CTF" />
  <meta name="twitter:site" content="@twitter" />
  <meta name="twitter:creator" content="@twitter" />
  <meta property="og:image:width" content="2000" />
  <meta property="og:image:height" content="666" />

  <link rel="canonical" href="https://t4k4.github.io//WhiteHat-Grand-Prix-2018-RE-writeup" />
  <link rel="alternate" type="application/rss+xml" title="TAKA" href="https://t4k4.github.io//feed.xml">

  <script type="application/ld+json">
  
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://t4k4.github.io//WhiteHat-Grand-Prix-2018-RE-writeup",
  "headline": "WhiteHat 2018 WP",
  "datePublished": "2020-01-18T22:27:34+00:00",
  "dateModified": "2020-01-18T22:27:34+00:00",
  "description": "re01",
  "author": {
    "@type": "Person",
    "name": ""
  },
  "publisher": {
    "@type": "Organization",
    "name": "TAKA",
    "logo": {
      "@type": "ImageObject",
      "url": "https://t4k4.github.io//assets/images/logo_bear.png",
      "width": "60",
      "height": "60"
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://t4k4.github.io//assets/images/logo_bear.png",
    "height": "60",
    "width": "60"
  }
}

  </script>

  <style amp-custom>
  
  "UTF-8";
.highlight .hll {
  background-color: #373b41; }

.highlight {
  background: #1d1f21;
  color: #c5c8c6; }

.highlight .c {
  color: #969896; }

/* Comment */
.highlight .err {
  color: #cc6666; }

/* Error */
.highlight .k {
  color: #b294bb; }

/* Keyword */
.highlight .l {
  color: #de935f; }

/* Literal */
.highlight .n {
  color: #c5c8c6; }

/* Name */
.highlight .o {
  color: #8abeb7; }

/* Operator */
.highlight .p {
  color: #c5c8c6; }

/* Punctuation */
.highlight .cm {
  color: #969896; }

/* Comment.Multiline */
.highlight .cp {
  color: #969896; }

/* Comment.Preproc */
.highlight .c1 {
  color: #969896; }

/* Comment.Single */
.highlight .cs {
  color: #969896; }

/* Comment.Special */
.highlight .gd {
  color: #cc6666; }

/* Generic.Deleted */
.highlight .ge {
  font-style: italic; }

/* Generic.Emph */
.highlight .gh {
  color: #c5c8c6;
  font-weight: bold; }

/* Generic.Heading */
.highlight .gi {
  color: #b5bd68; }

/* Generic.Inserted */
.highlight .gp {
  color: #969896;
  font-weight: bold; }

/* Generic.Prompt */
.highlight .gs {
  font-weight: bold; }

/* Generic.Strong */
.highlight .gu {
  color: #8abeb7;
  font-weight: bold; }

/* Generic.Subheading */
.highlight .kc {
  color: #b294bb; }

/* Keyword.Constant */
.highlight .kd {
  color: #b294bb; }

/* Keyword.Declaration */
.highlight .kn {
  color: #8abeb7; }

/* Keyword.Namespace */
.highlight .kp {
  color: #b294bb; }

/* Keyword.Pseudo */
.highlight .kr {
  color: #b294bb; }

/* Keyword.Reserved */
.highlight .kt {
  color: #f0c674; }

/* Keyword.Type */
.highlight .ld {
  color: #b5bd68; }

/* Literal.Date */
.highlight .m {
  color: #de935f; }

/* Literal.Number */
.highlight .s {
  color: #b5bd68; }

/* Literal.String */
.highlight .na {
  color: #81a2be; }

/* Name.Attribute */
.highlight .nb {
  color: #c5c8c6; }

/* Name.Builtin */
.highlight .nc {
  color: #f0c674; }

/* Name.Class */
.highlight .no {
  color: #cc6666; }

/* Name.Constant */
.highlight .nd {
  color: #8abeb7; }

/* Name.Decorator */
.highlight .ni {
  color: #c5c8c6; }

/* Name.Entity */
.highlight .ne {
  color: #cc6666; }

/* Name.Exception */
.highlight .nf {
  color: #81a2be; }

/* Name.Function */
.highlight .nl {
  color: #c5c8c6; }

/* Name.Label */
.highlight .nn {
  color: #f0c674; }

/* Name.Namespace */
.highlight .nx {
  color: #81a2be; }

/* Name.Other */
.highlight .py {
  color: #c5c8c6; }

/* Name.Property */
.highlight .nt {
  color: #8abeb7; }

/* Name.Tag */
.highlight .nv {
  color: #cc6666; }

/* Name.Variable */
.highlight .ow {
  color: #8abeb7; }

/* Operator.Word */
.highlight .w {
  color: #c5c8c6; }

/* Text.Whitespace */
.highlight .mf {
  color: #de935f; }

/* Literal.Number.Float */
.highlight .mh {
  color: #de935f; }

/* Literal.Number.Hex */
.highlight .mi {
  color: #de935f; }

/* Literal.Number.Integer */
.highlight .mo {
  color: #de935f; }

/* Literal.Number.Oct */
.highlight .sb {
  color: #b5bd68; }

/* Literal.String.Backtick */
.highlight .sc {
  color: #c5c8c6; }

/* Literal.String.Char */
.highlight .sd {
  color: #969896; }

/* Literal.String.Doc */
.highlight .s2 {
  color: #b5bd68; }

/* Literal.String.Double */
.highlight .se {
  color: #de935f; }

/* Literal.String.Escape */
.highlight .sh {
  color: #b5bd68; }

/* Literal.String.Heredoc */
.highlight .si {
  color: #de935f; }

/* Literal.String.Interpol */
.highlight .sx {
  color: #b5bd68; }

/* Literal.String.Other */
.highlight .sr {
  color: #b5bd68; }

/* Literal.String.Regex */
.highlight .s1 {
  color: #b5bd68; }

/* Literal.String.Single */
.highlight .ss {
  color: #b5bd68; }

/* Literal.String.Symbol */
.highlight .bp {
  color: #c5c8c6; }

/* Name.Builtin.Pseudo */
.highlight .vc {
  color: #cc6666; }

/* Name.Variable.Class */
.highlight .vg {
  color: #cc6666; }

/* Name.Variable.Global */
.highlight .vi {
  color: #cc6666; }

/* Name.Variable.Instance */
.highlight .il {
  color: #de935f; }

/* Literal.Number.Integer.Long */
.icon > svg {
  display: inline-block;
  width: 16px;
  height: 16px;
  vertical-align: middle; }
  .icon > svg path {
    fill: #828282; }

.cf:after {
  content: "";
  display: table;
  clear: both; }

main {
  display: block; }

body {
  background-color: #fff;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif;
  margin: 0;
  padding: 0;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-font-feature-settings: "liga=1, dlig=1";
  -ms-font-feature-settings: "liga", "dlig";
  -webkit-font-feature-settings: "liga", "dlig";
  -o-font-feature-settings: "liga", "dlig";
  font-feature-settings: "liga", "dlig"; }

.site-header {
  position: relative;
  width: 100%;
  max-width: 700px;
  margin: 16px auto 0 auto;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  @media only screen and (max-width: 800px) {
    .site-header {
      padding: 0 16px; } }
  .site-header .page-links {
    display: block;
    position: absolute;
    top: 10px;
    right: 16px;
    font-weight: 200;
    font-style: normal;
    font-size: 18px;
    line-height: 30px; }
    .site-header .page-links a {
      text-decoration: none;
      color: #999999; }
      .site-header .page-links a:hover {
        color: #333333; }

.blog-header {
  width: 100%;
  max-width: 700px;
  margin: 0 auto;
  position: relative;
  padding: 0;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  .blog-header .blog-title {
    margin-bottom: 8px;
    font-size: 50px;
    font-weight: 700;
    letter-spacing: -2px;
    outline: 0;
    line-height: 50px;
    word-break: break-word;
    color: #333333; }
  .blog-header .blog-description {
    font-size: 28px;
    margin: 0 0 20px;
    padding: 0;
    line-height: 1.2;
    color: #666666;
    font-weight: 300; }

.content {
  width: 100%;
  max-width: 700px;
  margin: 25px auto 0 auto;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  @media only screen and (max-width: 800px) {
    .content {
      padding: 0 16px; } }
  .content article {
    padding: 20px 0;
    border-bottom: 1px solid #f2f2f0; }
    .content article .post-title {
      letter-spacing: -0.02em;
      font-weight: 700;
      font-style: normal;
      display: block;
      font-size: 30px;
      line-height: 1.15;
      margin-bottom: 10px; }
      .content article .post-title a {
        text-decoration: none;
        color: #333332; }
        .content article .post-title a:hover {
          color: #ff6f00;
          text-decoration: none; }
    .content article .post-excerpt {
      letter-spacing: -0.02em;
      font-weight: 300;
      font-style: normal;
      font-size: 20px;
      line-height: 1.59;
      color: #666665;
      text-align: justify; }
    .content article .post-description {
      padding: 0;
      margin: 0; }
    .content article .post-meta {
      font-size: 14px;
      color: #b3b3b1;
      line-height: 30px;
      margin-top: 20px; }
      .content article .post-meta a {
        color: #b3b3b1;
        text-decoration: none; }
        .content article .post-meta a:hover {
          text-decoration: underline; }

.post-template .content {
  max-width: 700px; }

.index-headline {
  border-top: 1px solid #dededc;
  margin: 0;
  padding: 16px 0; }
  .index-headline span {
    color: #b3b3b1;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px; }

.pagination {
  text-align: center;
  padding: 16px 0 0;
  font-size: 12px;
  color: #9EABB3; }
  .pagination a {
    color: #999999;
    text-decoration: none; }
    .pagination a:hover {
      color: #333333; }

.site-footer {
  margin: 0 auto;
  padding: 48px 0;
  width: 100%;
  max-width: 700px;
  font-size: 12px;
  text-align: center;
  color: #999999;
  line-height: 17.6px; }
  .site-footer a {
    color: #666666;
    text-decoration: none; }
    .site-footer a:hover {
      color: #333333; }

.post .post-meta {
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
.post .post-title {
  font-weight: 700;
  font-style: normal;
  letter-spacing: -0.04em;
  font-size: 50px;
  line-height: 1.1;
  color: #333332;
  margin-bottom: 50px;
  text-align: left;
  padding: 0; }
.post .author-image {
  background-image: url(/);
  display: inline-block;
  width: 30px;
  height: 30px;
  line-height: 30px;
  margin-right: 8px;
  margin-bottom: -10px;
  float: left;
  background-size: cover;
  border-radius: 100%;
  text-indent: -9999px; }
.post .post-meta-text {
  color: #b3b3b1;
  letter-spacing: -0.02em;
  font-weight: 400;
  font-style: normal;
  font-size: 14px;
  overflow: hidden;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif;
  white-space: nowrap;
  text-overflow: ellipsis; }
.post .post-content {
  width: 100%;
  font-family: Georgia, Cambria, "Times New Roman", Times, "Lora", serif;
  color: #333333; }
  .post .post-content h1, .post .post-content h2, .post .post-content h3 {
    font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .post-content h3, .post .post-content h4, .post .post-content h5, .post .post-content h6 {
    letter-spacing: -0.02em;
    font-weight: 700;
    font-style: normal;
    font-size: 24px;
    line-height: 1.3;
    margin-top: 50px;
    margin-bottom: 0px;
    font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .post-content h3 {
    font-size: 36px; }
  .post .post-content h2, .post .post-content h1 {
    letter-spacing: -0.02em;
    font-weight: 700;
    font-style: normal;
    font-size: 42px;
    line-height: 1.2;
    margin-top: 50px;
    margin-bottom: 0px; }
  .post .post-content table {
    border-collapse: collapse; }
  .post .post-content table, .post .post-content th, .post .post-content td {
    border: 1px solid black;
    padding: 5px;
    text-align: left; }
  .post .post-content p {
    font-weight: 400;
    font-style: normal;
    font-size: 22px;
    line-height: 1.59;
    letter-spacing: -.002em;
    margin-top: 30px;
    margin-bottom: 0;
    color: #333333;
    -webkit-hyphens: auto;
    -moz-hyphens: auto;
    hyphens: auto; }
  .post .post-content a {
    color: #333333;
    text-decoration: underline; }
  .post .post-content amp-img, .post .post-content amp-youtube {
    margin-top: 30px; }
  .post .post-content figure {
    margin: 0;
    padding: 0 0 30px; }
  .post .post-content figcaption {
    font-weight: 400;
    font-style: italic;
    font-size: 16px;
    line-height: 1.3;
    color: #666665;
    outline: 0;
    z-index: 300;
    text-align: center; }
  .post .post-content hr {
    border: 0;
    padding: 0;
    display: block;
    width: 15%;
    margin: 30px auto;
    border: 0px solid #dddddd;
    border-top: 1px solid #dddddd; }
  .post .post-content blockquote {
    margin: 0 0 30px;
    margin-left: -26px;
    border-left: 3px solid #57ad68;
    padding-left: 20px; }
    .post .post-content blockquote p {
      letter-spacing: 0.01rem;
      font-weight: 400;
      mborder-left: 3px solid #57ad68;
      mpadding-left: 20px;
      mmargin-left: -26px;
      padding-bottom: 3px; }
  .post .post-content ul, .post .post-content ol {
    padding: 0 0 30px;
    margin: 0; }
  .post .post-content li {
    padding: 0;
    font-weight: 400;
    font-style: normal;
    font-size: 23px;
    line-height: 30px;
    margin-left: 30px;
    margin-bottom: 12px;
    padding-top: 2px; }
    .post .post-content li p {
      padding: 0 0 1.618rem; }
  .post .post-content ol li {
    list-style-type: decimal; }
.post .bottom-teaser {
  padding: 50px 0 0 0;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .bottom-teaser hr {
    border: 0;
    padding: 0;
    display: block;
    width: 15%;
    margin: 16px 0 16px 100px;
    border: 0px solid #dddddd;
    border-top: 1px solid #dddddd; }
  .post .bottom-teaser .isLeft {
    float: left;
    width: 47%;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box; }
    @media only screen and (max-width: 800px) {
      .post .bottom-teaser .isLeft {
        width: 100%;
        padding-bottom: 32px; } }
    .post .bottom-teaser .isLeft .bio {
      margin-top: 18px;
      margin-bottom: 18px; }
    .post .bottom-teaser .isLeft .username {
      margin-left: 4px;
      margin-right: 18px;
      margin-bottom: 18px; }
    .post .bottom-teaser .isLeft .index-headline {
      padding-bottom: 32px; }
    .post .bottom-teaser .isLeft a {
      color: black;
      text-decoration: none; }
      .post .bottom-teaser .isLeft a:hover {
        color: #333333;
        text-decoration: underline; }
    .post .bottom-teaser .isLeft .author-image {
      display: block;
      width: 80px;
      height: 80px;
      float: left;
      background-size: cover;
      border-radius: 100%;
      text-indent: -9999px; }
    .post .bottom-teaser .isLeft h4 {
      font-size: 18px;
      line-height: 1.1;
      font-weight: 700;
      padding: 0;
      margin: 0;
      padding-left: 100px; }
    .post .bottom-teaser .isLeft p {
      font-size: 14px;
      line-height: 1.3;
      font-weight: 400;
      padding: 0;
      margin: 0;
      padding-left: 100px; }
      .post .bottom-teaser .isLeft p.published {
        color: #999999; }
  .post .bottom-teaser .isRight {
    float: right;
    width: 47%;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box; }
    @media only screen and (max-width: 800px) {
      .post .bottom-teaser .isRight {
        width: 100%; } }
    .post .bottom-teaser .isRight .index-headline {
      padding-bottom: 32px; }
    .post .bottom-teaser .isRight .site-footer {
      margin: 0;
      padding: 0;
      color: #333333;
      text-align: left;
      font-size: 14px;
      line-height: 1.3;
      color: #999999; }
      .post .bottom-teaser .isRight .site-footer a {
        color: #333333;
        text-decoration: none; }
        .post .bottom-teaser .isRight .site-footer a:hover {
          text-decoration: underline; }
      .post .bottom-teaser .isRight .site-footer .poweredby {
        display: block;
        padding-bottom: 18px;
        font-weight: 700;
        color: #333333; }

.share {
  text-align: right;
  padding: 20px 0 0; }
  .share a {
    text-decoration: none;
    color: #bbbbbb;
    padding-left: 12px; }
    .share a .hidden {
      display: none; }
    .share a:hover {
      color: #333333; }

pre,
code {
  font-size: 15px;
  border: 1px solid #e8e8e8;
  border-radius: 3px; }

code {
  padding: 1px 5px; }

pre {
  padding: 8px 12px;
  overflow-x: scroll; }
  pre > code {
    border: 0;
    padding-right: 0;
    padding-left: 0; }

.pagination .disabled {
  opacity: 0; }

html {
  font-family: sans-serif;
  line-height: 1.15;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%; }

body {
  margin: 0; }

article, aside, footer, header, nav, section {
  display: block; }

h1 {
  font-size: 2em;
  margin: .67em 0; }

figcaption, figure, main {
  display: block; }

figure {
  margin: 1em 40px; }

hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible; }

pre {
  font-family: monospace,monospace;
  font-size: 1em; }

a {
  background-color: transparent;
  -webkit-text-decoration-skip: objects;
  text-decoration: none;
  color: #ff6f00; }

a:active, a:hover {
  outline-width: 0; }

abbr[title] {
  border-bottom: none;
  text-decoration: underline;
  text-decoration: underline dotted; }

b, strong {
  font-weight: inherit;
  font-weight: bolder; }

code, kbd, samp {
  font-family: monospace,monospace;
  font-size: 1em; }

dfn {
  font-style: italic; }

mark {
  background-color: #ff0;
  color: #000; }

small {
  font-size: 80%; }

sub, sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline; }

sub {
  bottom: -.25em; }

sup {
  top: -.5em; }

audio, video {
  display: inline-block; }

audio:not([controls]) {
  display: none;
  height: 0; }

img {
  border-style: none; }

svg:not(:root) {
  overflow: hidden; }

button, input, optgroup, select, textarea {
  font-family: sans-serif;
  font-size: 100%;
  line-height: 1.15;
  margin: 0; }

button, input {
  overflow: visible; }

button, select {
  text-transform: none; }

[type=reset], [type=submit], button, html [type=button] {
  -webkit-appearance: button; }

[type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner, button::-moz-focus-inner {
  border-style: none;
  padding: 0; }

[type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring, button:-moz-focusring {
  outline: 1px dotted ButtonText; }

fieldset {
  border: 1px solid silver;
  margin: 0 2px;
  padding: .35em .625em .75em; }

legend {
  box-sizing: border-box;
  color: inherit;
  display: table;
  max-width: 100%;
  padding: 0;
  white-space: normal; }

progress {
  display: inline-block;
  vertical-align: baseline; }

textarea {
  overflow: auto; }

[type=checkbox], [type=radio] {
  box-sizing: border-box;
  padding: 0; }

[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button {
  height: auto; }

[type=search] {
  -webkit-appearance: textfield;
  outline-offset: -2px; }

[type=search]::-webkit-search-cancel-button, [type=search]::-webkit-search-decoration {
  -webkit-appearance: none; }

::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit; }

details, menu {
  display: block; }

summary {
  display: list-item; }

canvas {
  display: inline-block; }

[hidden], template {
  display: none; }

.h1 {
  font-size: 3rem; }

.h2 {
  font-size: 2rem; }

.h3 {
  font-size: 1.5rem; }

.h4 {
  font-size: 1.125rem; }

.h5 {
  font-size: .875rem; }

.h6 {
  font-size: .75rem; }

.font-family-inherit {
  font-family: inherit; }

.font-size-inherit {
  font-size: inherit; }

.text-decoration-none {
  text-decoration: none; }

.bold {
  font-weight: 700; }

.regular {
  font-weight: 400; }

.italic {
  font-style: italic; }

.caps {
  text-transform: uppercase;
  letter-spacing: .2em; }

.left-align {
  text-align: left; }

.center {
  text-align: center; }

.right-align {
  text-align: right; }

.justify {
  text-align: justify; }

.nowrap {
  white-space: nowrap; }

.break-word {
  word-wrap: break-word; }

.line-height-1 {
  line-height: 1rem; }

.line-height-2 {
  line-height: 1.125rem; }

.line-height-3 {
  line-height: 1.5rem; }

.line-height-4 {
  line-height: 2rem; }

.list-style-none {
  list-style: none; }

.underline {
  text-decoration: underline; }

.truncate {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap; }

.list-reset {
  list-style: none;
  padding-left: 0; }

.inline {
  display: inline; }

.block {
  display: block; }

.inline-block {
  display: inline-block; }

.table {
  display: table; }

.table-cell {
  display: table-cell; }

.overflow-hidden {
  overflow: hidden; }

.overflow-scroll {
  overflow: scroll; }

.overflow-auto {
  overflow: auto; }

.clearfix:after, .clearfix:before {
  content: " ";
  display: table; }

.clearfix:after {
  clear: both; }

.left {
  float: left; }

.right {
  float: right; }

.fit {
  max-width: 100%; }

.max-width-1 {
  max-width: 24rem; }

.max-width-2 {
  max-width: 32rem; }

.max-width-3 {
  max-width: 48rem; }

.max-width-4 {
  max-width: 64rem; }

.border-box {
  box-sizing: border-box; }

.align-baseline {
  vertical-align: baseline; }

.align-top {
  vertical-align: top; }

.align-middle {
  vertical-align: middle; }

.align-bottom {
  vertical-align: bottom; }

.m0 {
  margin: 0; }

.mt0 {
  margin-top: 0; }

.mr0 {
  margin-right: 0; }

.mb0 {
  margin-bottom: 0; }

.ml0, .mx0 {
  margin-left: 0; }

.mx0 {
  margin-right: 0; }

.my0 {
  margin-top: 0;
  margin-bottom: 0; }

.m1 {
  margin: .5rem; }

.mt1 {
  margin-top: .5rem; }

.mr1 {
  margin-right: .5rem; }

.mb1 {
  margin-bottom: .5rem; }

.ml1, .mx1 {
  margin-left: .5rem; }

.mx1 {
  margin-right: .5rem; }

.my1 {
  margin-top: .5rem;
  margin-bottom: .5rem; }

.m2 {
  margin: 1rem; }

.mt2 {
  margin-top: 1rem; }

.mr2 {
  margin-right: 1rem; }

.mb2 {
  margin-bottom: 1rem; }

.ml2, .mx2 {
  margin-left: 1rem; }

.mx2 {
  margin-right: 1rem; }

.my2 {
  margin-top: 1rem;
  margin-bottom: 1rem; }

.m3 {
  margin: 1.5rem; }

.mt3 {
  margin-top: 1.5rem; }

.mr3 {
  margin-right: 1.5rem; }

.mb3 {
  margin-bottom: 1.5rem; }

.ml3, .mx3 {
  margin-left: 1.5rem; }

.mx3 {
  margin-right: 1.5rem; }

.my3 {
  margin-top: 1.5rem;
  margin-bottom: 1.5rem; }

.m4 {
  margin: 2rem; }

.mt4 {
  margin-top: 2rem; }

.mr4 {
  margin-right: 2rem; }

.mb4 {
  margin-bottom: 2rem; }

.ml4, .mx4 {
  margin-left: 2rem; }

.mx4 {
  margin-right: 2rem; }

.my4 {
  margin-top: 2rem;
  margin-bottom: 2rem; }

.mxn1 {
  margin-left: -.5rem;
  margin-right: -.5rem; }

.mxn2 {
  margin-left: -1rem;
  margin-right: -1rem; }

.mxn3 {
  margin-left: -1.5rem;
  margin-right: -1.5rem; }

.mxn4 {
  margin-left: -2rem;
  margin-right: -2rem; }

.ml-auto {
  margin-left: auto; }

.mr-auto, .mx-auto {
  margin-right: auto; }

.mx-auto {
  margin-left: auto; }

.p0 {
  padding: 0; }

.pt0 {
  padding-top: 0; }

.pr0 {
  padding-right: 0; }

.pb0 {
  padding-bottom: 0; }

.pl0, .px0 {
  padding-left: 0; }

.px0 {
  padding-right: 0; }

.py0 {
  padding-top: 0;
  padding-bottom: 0; }

.p1 {
  padding: .5rem; }

.pt1 {
  padding-top: .5rem; }

.pr1 {
  padding-right: .5rem; }

.pb1 {
  padding-bottom: .5rem; }

.pl1 {
  padding-left: .5rem; }

.py1 {
  padding-top: .5rem;
  padding-bottom: .5rem; }

.px1 {
  padding-left: .5rem;
  padding-right: .5rem; }

.p2 {
  padding: 1rem; }

.pt2 {
  padding-top: 1rem; }

.pr2 {
  padding-right: 1rem; }

.pb2 {
  padding-bottom: 1rem; }

.pl2 {
  padding-left: 1rem; }

.py2 {
  padding-top: 1rem;
  padding-bottom: 1rem; }

.px2 {
  padding-left: 1rem;
  padding-right: 1rem; }

.p3 {
  padding: 1.5rem; }

.pt3 {
  padding-top: 1.5rem; }

.pr3 {
  padding-right: 1.5rem; }

.pb3 {
  padding-bottom: 1.5rem; }

.pl3 {
  padding-left: 1.5rem; }

.py3 {
  padding-top: 1.5rem;
  padding-bottom: 1.5rem; }

.px3 {
  padding-left: 1.5rem;
  padding-right: 1.5rem; }

.p4 {
  padding: 2rem; }

.pt4 {
  padding-top: 2rem; }

.pr4 {
  padding-right: 2rem; }

.pb4 {
  padding-bottom: 2rem; }

.pl4 {
  padding-left: 2rem; }

.py4 {
  padding-top: 2rem;
  padding-bottom: 2rem; }

.px4 {
  padding-left: 2rem;
  padding-right: 2rem; }

.col {
  float: left; }

.col, .col-right {
  box-sizing: border-box; }

.col-right {
  float: right; }

.col-1 {
  width: 8.33333%; }

.col-2 {
  width: 16.66667%; }

.col-3 {
  width: 25%; }

.col-4 {
  width: 33.33333%; }

.col-5 {
  width: 41.66667%; }

.col-6 {
  width: 50%; }

.col-7 {
  width: 58.33333%; }

.col-8 {
  width: 66.66667%; }

.col-9 {
  width: 75%; }

.col-10 {
  width: 83.33333%; }

.col-11 {
  width: 91.66667%; }

.col-12 {
  width: 100%; }

@media (min-width: 40.06rem) {
  .sm-col {
    float: left;
    box-sizing: border-box; }

  .sm-col-right {
    float: right;
    box-sizing: border-box; }

  .sm-col-1 {
    width: 8.33333%; }

  .sm-col-2 {
    width: 16.66667%; }

  .sm-col-3 {
    width: 25%; }

  .sm-col-4 {
    width: 33.33333%; }

  .sm-col-5 {
    width: 41.66667%; }

  .sm-col-6 {
    width: 50%; }

  .sm-col-7 {
    width: 58.33333%; }

  .sm-col-8 {
    width: 66.66667%; }

  .sm-col-9 {
    width: 75%; }

  .sm-col-10 {
    width: 83.33333%; }

  .sm-col-11 {
    width: 91.66667%; }

  .sm-col-12 {
    width: 100%; } }
@media (min-width: 52.06rem) {
  .md-col {
    float: left;
    box-sizing: border-box; }

  .md-col-right {
    float: right;
    box-sizing: border-box; }

  .md-col-1 {
    width: 8.33333%; }

  .md-col-2 {
    width: 16.66667%; }

  .md-col-3 {
    width: 25%; }

  .md-col-4 {
    width: 33.33333%; }

  .md-col-5 {
    width: 41.66667%; }

  .md-col-6 {
    width: 50%; }

  .md-col-7 {
    width: 58.33333%; }

  .md-col-8 {
    width: 66.66667%; }

  .md-col-9 {
    width: 75%; }

  .md-col-10 {
    width: 83.33333%; }

  .md-col-11 {
    width: 91.66667%; }

  .md-col-12 {
    width: 100%; } }
@media (min-width: 64.06rem) {
  .lg-col {
    float: left;
    box-sizing: border-box; }

  .lg-col-right {
    float: right;
    box-sizing: border-box; }

  .lg-col-1 {
    width: 8.33333%; }

  .lg-col-2 {
    width: 16.66667%; }

  .lg-col-3 {
    width: 25%; }

  .lg-col-4 {
    width: 33.33333%; }

  .lg-col-5 {
    width: 41.66667%; }

  .lg-col-6 {
    width: 50%; }

  .lg-col-7 {
    width: 58.33333%; }

  .lg-col-8 {
    width: 66.66667%; }

  .lg-col-9 {
    width: 75%; }

  .lg-col-10 {
    width: 83.33333%; }

  .lg-col-11 {
    width: 91.66667%; }

  .lg-col-12 {
    width: 100%; } }
.flex {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex; }

@media (min-width: 40.06rem) {
  .sm-flex {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex; } }
@media (min-width: 52.06rem) {
  .md-flex {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex; } }
@media (min-width: 64.06rem) {
  .lg-flex {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex; } }
.flex-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -ms-flex-direction: column;
  flex-direction: column; }

.flex-wrap {
  -ms-flex-wrap: wrap;
  flex-wrap: wrap; }

.items-start {
  -webkit-box-align: start;
  -ms-flex-align: start;
  align-items: flex-start; }

.items-end {
  -webkit-box-align: end;
  -ms-flex-align: end;
  align-items: flex-end; }

.items-center {
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center; }

.items-baseline {
  -webkit-box-align: baseline;
  -ms-flex-align: baseline;
  align-items: baseline; }

.items-stretch {
  -webkit-box-align: stretch;
  -ms-flex-align: stretch;
  align-items: stretch; }

.self-start {
  -ms-flex-item-align: start;
  align-self: flex-start; }

.self-end {
  -ms-flex-item-align: end;
  align-self: flex-end; }

.self-center {
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  align-self: center; }

.self-baseline {
  -ms-flex-item-align: baseline;
  align-self: baseline; }

.self-stretch {
  -ms-flex-item-align: stretch;
  -ms-grid-row-align: stretch;
  align-self: stretch; }

.justify-start {
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  justify-content: flex-start; }

.justify-end {
  -webkit-box-pack: end;
  -ms-flex-pack: end;
  justify-content: flex-end; }

.justify-center {
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  justify-content: center; }

.justify-between {
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  justify-content: space-between; }

.justify-around {
  -ms-flex-pack: distribute;
  justify-content: space-around; }

.content-start {
  -ms-flex-line-pack: start;
  align-content: flex-start; }

.content-end {
  -ms-flex-line-pack: end;
  align-content: flex-end; }

.content-center {
  -ms-flex-line-pack: center;
  align-content: center; }

.content-between {
  -ms-flex-line-pack: justify;
  align-content: space-between; }

.content-around {
  -ms-flex-line-pack: distribute;
  align-content: space-around; }

.content-stretch {
  -ms-flex-line-pack: stretch;
  align-content: stretch; }

.flex-auto {
  -webkit-box-flex: 1;
  -ms-flex: 1 1 auto;
  flex: 1 1 auto;
  min-width: 0;
  min-height: 0; }

.flex-none {
  -webkit-box-flex: 0;
  -ms-flex: none;
  flex: none; }

.order-0 {
  -webkit-box-ordinal-group: 1;
  -ms-flex-order: 0;
  order: 0; }

.order-1 {
  -webkit-box-ordinal-group: 2;
  -ms-flex-order: 1;
  order: 1; }

.order-2 {
  -webkit-box-ordinal-group: 3;
  -ms-flex-order: 2;
  order: 2; }

.order-3 {
  -webkit-box-ordinal-group: 4;
  -ms-flex-order: 3;
  order: 3; }

.order-last {
  -webkit-box-ordinal-group: 100000;
  -ms-flex-order: 99999;
  order: 99999; }

.relative {
  position: relative; }

.absolute {
  position: absolute; }

.fixed {
  position: fixed; }

.top-0 {
  top: 0; }

.right-0 {
  right: 0; }

.bottom-0 {
  bottom: 0; }

.left-0 {
  left: 0; }

.z1 {
  z-index: 1; }

.z2 {
  z-index: 2; }

.z3 {
  z-index: 3; }

.z4 {
  z-index: 4; }

.border {
  border-style: solid;
  border-width: 1px; }

.border-top {
  border-top-style: solid;
  border-top-width: 1px; }

.border-right {
  border-right-style: solid;
  border-right-width: 1px; }

.border-bottom {
  border-bottom-style: solid;
  border-bottom-width: 1px; }

.border-left {
  border-left-style: solid;
  border-left-width: 1px; }

.border-none {
  border: 0; }

.rounded {
  border-radius: 3px; }

.circle {
  border-radius: 50%; }

.rounded-top {
  border-radius: 3px 3px 0 0; }

.rounded-right {
  border-radius: 0 3px 3px 0; }

.rounded-bottom {
  border-radius: 0 0 3px 3px; }

.rounded-left {
  border-radius: 3px 0 0 3px; }

.not-rounded {
  border-radius: 0; }

.hide {
  position: absolute;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px, 1px, 1px, 1px); }

@media (max-width: 40rem) {
  .xs-hide {
    display: none; } }
@media (min-width: 40.06rem) and (max-width: 52rem) {
  .sm-hide {
    display: none; } }
@media (min-width: 52.06rem) and (max-width: 64rem) {
  .md-hide {
    display: none; } }
@media (min-width: 64.06rem) {
  .lg-hide {
    display: none; } }
.display-none {
  display: none; }

* {
  box-sizing: border-box; }

body {
  background: #fff;
  color: #4a4a4a;
  font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Arial,sans-serif;
  min-width: 315px;
  overflow-x: hidden;
  font-smooth: always;
  -webkit-font-smoothing: antialiased; }

main {
  max-width: 700px;
  margin: 0 auto; }

p {
  padding: 0;
  margin: 0; }

.ampstart-accent {
  color: #ff6f00; }

#content:target {
  margin-top: calc(0px - 3.5rem);
  padding-top: 3.5rem; }

.ampstart-title-lg {
  font-size: 3rem;
  line-height: 3.5rem;
  letter-spacing: .06rem; }

.ampstart-title-md {
  font-size: 2rem;
  line-height: 2.5rem;
  letter-spacing: .06rem; }

.ampstart-title-sm {
  font-size: 1.5rem;
  line-height: 2rem;
  letter-spacing: .06rem; }

.ampstart-subtitle, body {
  line-height: 1.5rem;
  letter-spacing: normal; }

.ampstart-subtitle {
  color: #ff6f00;
  font-size: 1rem; }

.ampstart-byline, .ampstart-caption, .ampstart-hint, .ampstart-label {
  font-size: .875rem;
  color: #4f4f4f;
  line-height: 1.125rem;
  letter-spacing: .06rem; }

.ampstart-label {
  text-transform: uppercase; }

.ampstart-footer, .ampstart-small-text {
  font-size: .75rem;
  line-height: 1rem;
  letter-spacing: .06rem; }

.ampstart-card {
  box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.14), 0 1px 1px -1px rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12); }

.h1, h1 {
  font-size: 3rem;
  line-height: 3.5rem; }

.h2, h2 {
  font-size: 2rem;
  line-height: 2.5rem; }

.h3, h3 {
  font-size: 1.5rem;
  line-height: 2rem; }

.h4, h4 {
  font-size: 1.125rem;
  line-height: 1.5rem; }

.h5, h5 {
  font-size: .875rem;
  line-height: 1.125rem; }

.h6, h6 {
  font-size: .75rem;
  line-height: 1rem; }

h1, h2, h3, h4, h5, h6 {
  margin: 0;
  padding: 0;
  font-weight: 400;
  letter-spacing: .06rem; }

a, a:active, a:visited {
  color: #ff6f00; }

.ampstart-btn {
  font-family: inherit;
  font-weight: inherit;
  font-size: 1rem;
  line-height: 1.125rem;
  padding: .7em .8em;
  text-decoration: none;
  white-space: nowrap;
  word-wrap: normal;
  vertical-align: middle;
  cursor: pointer;
  background-color: #ff6f00;
  color: #fff;
  border: 1px solid #fff; }

.ampstart-btn:visited {
  color: #fff; }

.ampstart-btn-secondary {
  background-color: #fff;
  color: #000;
  border: 1px solid #000; }

.ampstart-btn-secondary:visited {
  color: #000; }

.ampstart-btn:active .ampstart-btn:focus {
  opacity: .8; }

.ampstart-btn[disabled], .ampstart-btn[disabled]:active, .ampstart-btn[disabled]:focus, .ampstart-btn[disabled]:hover {
  opacity: .5;
  outline: 0;
  cursor: default; }

.ampstart-dropcap:first-letter {
  color: #000;
  font-size: 3rem;
  font-weight: 700;
  float: left;
  overflow: hidden;
  line-height: 3rem;
  margin-left: 0;
  margin-right: .5rem; }

.ampstart-initialcap {
  padding-top: 1rem;
  margin-top: 1.5rem; }

.ampstart-initialcap:first-letter {
  color: #ff6f00;
  font-size: 3rem;
  font-weight: 700;
  margin-left: -2px; }

.ampstart-pullquote {
  border: none;
  border-left: 4px solid #000;
  font-size: 1.5rem;
  padding-left: 1.5rem; }

.ampstart-byline time {
  font-style: normal;
  white-space: nowrap; }

.amp-carousel-button-next {
  background-image: url('data:image/svg+xml;charset=utf-8,<svg width="18" height="18" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>Next</title><path d="M25.557 14.7L13.818 2.961 16.8 0l16.8 16.8-16.8 16.8-2.961-2.961L25.557 18.9H0v-4.2z" fill="#FFF" fill-rule="evenodd"/></svg>'); }

.amp-carousel-button-prev {
  background-image: url('data:image/svg+xml;charset=utf-8,<svg width="18" height="18" viewBox="0 0 34 34" xmlns="http://www.w3.org/2000/svg"><title>Previous</title><path d="M33.6 14.7H8.043L19.782 2.961 16.8 0 0 16.8l16.8 16.8 2.961-2.961L8.043 18.9H33.6z" fill="#FFF" fill-rule="evenodd"/></svg>'); }

.ampstart-dropdown {
  min-width: 200px; }

.ampstart-dropdown.absolute {
  z-index: 100; }

.ampstart-dropdown.absolute > section, .ampstart-dropdown.absolute > section > header {
  height: 100%; }

.ampstart-dropdown > section > header {
  background-color: #000;
  border: 0;
  color: #fff; }

.ampstart-dropdown > section > header:after {
  display: inline-block;
  content: "+";
  padding: 0 0 0 1.5rem;
  color: #ff6f00; }

.ampstart-dropdown > [expanded] > header:after {
  content: "–"; }

.absolute .ampstart-dropdown-items {
  z-index: 200; }

.ampstart-dropdown-item {
  background-color: #000;
  color: #ff6f00;
  opacity: .9; }

.ampstart-dropdown-item:active, .ampstart-dropdown-item:hover {
  opacity: 1; }

.ampstart-footer {
  background-color: #fff;
  color: #000;
  padding-top: 5rem;
  padding-bottom: 5rem; }

.ampstart-footer .ampstart-icon {
  fill: #ff6f00; }

.ampstart-footer .ampstart-social-follow li:last-child {
  margin-right: 0; }

.ampstart-image-fullpage-hero {
  color: #fff;
  background: #424242; }

.ampstart-fullpage-hero-heading-text, .ampstart-image-fullpage-hero .ampstart-image-credit {
  -webkit-box-decoration-break: clone;
  box-decoration-break: clone;
  background: #ff6f00;
  padding: 0 1rem .2rem; }

.ampstart-image-fullpage-hero > amp-img {
  max-height: calc(100vh - 3.5rem); }

.ampstart-image-fullpage-hero > amp-img img {
  -o-object-fit: cover;
  object-fit: cover; }

.ampstart-fullpage-hero-heading {
  font-size: 3rem;
  line-height: 1.5rem; }

.ampstart-fullpage-hero-cta {
  background: transparent; }

.ampstart-readmore {
  background: -webkit-linear-gradient(bottom, rgba(0, 0, 0, 0.65), transparent);
  background: linear-gradient(0deg, rgba(0, 0, 0, 0.65) 0, transparent);
  color: #fff;
  margin-top: 5rem;
  padding-bottom: 3.5rem; }

.ampstart-readmore:after {
  display: block;
  content: "⌄";
  font-size: 2rem; }

.ampstart-readmore-text {
  background: #000; }

@media (min-width: 52.06rem) {
  .ampstart-image-fullpage-hero > amp-img {
    height: 60vh; } }
.ampstart-image-heading {
  color: #fff;
  background: -webkit-linear-gradient(bottom, rgba(0, 0, 0, 0.65), transparent);
  background: linear-gradient(0deg, rgba(0, 0, 0, 0.65) 0, transparent); }

.ampstart-image-heading > * {
  margin: 0; }

amp-carousel .ampstart-image-with-heading {
  margin-bottom: 0; }

.ampstart-image-with-caption figcaption {
  color: #4f4f4f;
  line-height: 1.125rem; }

amp-carousel .ampstart-image-with-caption {
  margin-bottom: 0; }

.ampstart-input {
  max-width: 100%;
  width: 300px;
  min-width: 100px;
  font-size: 1rem;
  line-height: 1.5rem; }

.ampstart-input [disabled], .ampstart-input [disabled] + label {
  opacity: .5; }

.ampstart-input [disabled]:focus {
  outline: 0; }

.ampstart-input > input, .ampstart-input > select, .ampstart-input > textarea {
  width: 100%;
  margin-top: 1rem;
  line-height: 1.5rem;
  border: 0;
  border-radius: 0;
  border-bottom: 1px solid #4a4a4a;
  background: none;
  color: #4a4a4a;
  outline: 0; }

.ampstart-input > label {
  color: #ff6f00;
  pointer-events: none;
  text-align: left;
  font-size: .875rem;
  line-height: 1rem;
  opacity: 0;
  -webkit-animation: .2s;
  animation: .2s;
  -webkit-animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  -webkit-animation-fill-mode: forwards;
  animation-fill-mode: forwards; }

.ampstart-input > input:focus, .ampstart-input > select:focus, .ampstart-input > textarea:focus {
  outline: 0; }

.ampstart-input > input:focus::-webkit-input-placeholder, .ampstart-input > select:focus::-webkit-input-placeholder, .ampstart-input > textarea:focus::-webkit-input-placeholder {
  color: transparent; }

.ampstart-input > input:focus::-moz-placeholder, .ampstart-input > select:focus::-moz-placeholder, .ampstart-input > textarea:focus::-moz-placeholder {
  color: transparent; }

.ampstart-input > input:focus:-ms-input-placeholder, .ampstart-input > select:focus:-ms-input-placeholder, .ampstart-input > textarea:focus:-ms-input-placeholder {
  color: transparent; }

.ampstart-input > input:focus::placeholder, .ampstart-input > select:focus::placeholder, .ampstart-input > textarea:focus::placeholder {
  color: transparent; }

.ampstart-input > input:not(:placeholder-shown):not([disabled]) + label, .ampstart-input > select:not(:placeholder-shown):not([disabled]) + label, .ampstart-input > textarea:not(:placeholder-shown):not([disabled]) + label {
  opacity: 1; }

.ampstart-input > input:focus + label, .ampstart-input > select:focus + label, .ampstart-input > textarea:focus + label {
  -webkit-animation-name: a;
  animation-name: a; }

@-webkit-keyframes a {
  to {
    opacity: 1; } }
@keyframes a {
  to {
    opacity: 1; } }
.ampstart-input > label:after {
  content: "";
  height: 2px;
  position: absolute;
  bottom: 0;
  left: 45%;
  background: #ff6f00;
  -webkit-transition: .2s;
  transition: .2s;
  -webkit-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  visibility: hidden;
  width: 10px; }

.ampstart-input > input:focus + label:after, .ampstart-input > select:focus + label:after, .ampstart-input > textarea:focus + label:after {
  left: 0;
  width: 100%;
  visibility: visible; }

.ampstart-input > input[type=search] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none; }

.ampstart-input > input[type=range] {
  border-bottom: 0; }

.ampstart-input > input[type=range] + label:after {
  display: none; }

.ampstart-input > select {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none; }

.ampstart-input > select + label:before {
  content: "⌄";
  line-height: 1.5rem;
  position: absolute;
  right: 5px;
  zoom: 2;
  top: 0;
  bottom: 0;
  color: #ff6f00; }

.ampstart-input-chk, .ampstart-input-radio {
  width: auto;
  color: #4a4a4a; }

.ampstart-input input[type=checkbox], .ampstart-input input[type=radio] {
  margin-top: 0;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border: 1px solid #ff6f00;
  vertical-align: middle;
  margin-right: .5rem;
  text-align: center; }

.ampstart-input input[type=radio] {
  border-radius: 20px; }

.ampstart-input input[type=checkbox]:not([disabled]) + label, .ampstart-input input[type=radio]:not([disabled]) + label {
  pointer-events: auto;
  -webkit-animation: none;
  animation: none;
  vertical-align: middle;
  opacity: 1;
  cursor: pointer; }

.ampstart-input input[type=checkbox] + label:after, .ampstart-input input[type=radio] + label:after {
  display: none; }

.ampstart-input input[type=checkbox]:after, .ampstart-input input[type=radio]:after {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  content: " ";
  line-height: 1.4rem;
  vertical-align: middle;
  text-align: center;
  background-color: #fff; }

.ampstart-input input[type=checkbox]:checked:after {
  background-color: #ff6f00;
  color: #fff;
  content: "✓"; }

.ampstart-input input[type=radio]:checked {
  background-color: #fff; }

.ampstart-input input[type=radio]:after {
  top: 3px;
  bottom: 3px;
  left: 3px;
  right: 3px;
  border-radius: 12px; }

.ampstart-input input[type=radio]:checked:after {
  content: "";
  font-size: 3rem;
  background-color: #ff6f00; }

.ampstart-input > label, _:-ms-lang(x) {
  opacity: 1; }

.ampstart-input > input:-ms-input-placeholder, _:-ms-lang(x) {
  color: transparent; }

.ampstart-input > input::placeholder, _:-ms-lang(x) {
  color: transparent; }

.ampstart-input > input::-ms-input-placeholder, _:-ms-lang(x) {
  color: transparent; }

.ampstart-input > select::-ms-expand {
  display: none; }

.ampstart-headerbar {
  background-color: #ff6f00;
  color: #fff;
  z-index: 999;
  box-shadow: 0 0 5px 2px rgba(0, 0, 0, 0.1); }

.ampstart-headerbar + :not(amp-sidebar), .ampstart-headerbar + amp-sidebar + * {
  margin-top: 3.5rem; }

.ampstart-headerbar-nav .ampstart-nav-item {
  padding: 0 1rem;
  background: transparent;
  opacity: .8; }

.ampstart-headerbar-nav {
  line-height: 3.5rem; }

.ampstart-nav-item:active, .ampstart-nav-item:focus, .ampstart-nav-item:hover {
  opacity: 1; }

.ampstart-navbar-trigger:focus {
  outline: none; }

.ampstart-nav a, .ampstart-navbar-trigger, .ampstart-sidebar-faq a {
  cursor: pointer;
  text-decoration: none; }

.ampstart-nav .ampstart-label {
  color: inherit; }

.ampstart-navbar-trigger {
  line-height: 3.5rem;
  font-size: 2rem; }

.ampstart-headerbar-nav {
  -webkit-box-flex: 1;
  -ms-flex: 1;
  flex: 1; }

.ampstart-nav-search {
  -webkit-box-flex: 0.5;
  -ms-flex-positive: 0.5;
  flex-grow: 0.5; }

.ampstart-headerbar .ampstart-nav-search:active, .ampstart-headerbar .ampstart-nav-search:focus, .ampstart-headerbar .ampstart-nav-search:hover {
  box-shadow: none; }

.ampstart-nav-search > input {
  border: none;
  border-radius: 3px;
  line-height: normal; }

.ampstart-nav-dropdown {
  min-width: 200px; }

.ampstart-nav-dropdown amp-accordion header {
  background-color: #fff;
  border: none; }

.ampstart-nav-dropdown amp-accordion ul {
  background-color: #fff; }

.ampstart-nav-dropdown .ampstart-dropdown-item, .ampstart-nav-dropdown .ampstart-dropdown > section > header {
  background-color: #fff;
  color: #000; }

.ampstart-nav-dropdown .ampstart-dropdown-item {
  color: #ff6f00; }

.ampstart-sidebar {
  background-color: #fff;
  color: #ff6f00;
  min-width: 300px;
  width: 300px; }

.ampstart-sidebar .ampstart-icon {
  fill: #ff6f00; }

.ampstart-sidebar-header {
  line-height: 3.5rem;
  min-height: 3.5rem; }

.ampstart-sidebar .ampstart-dropdown-item, .ampstart-sidebar .ampstart-dropdown header, .ampstart-sidebar .ampstart-faq-item, .ampstart-sidebar .ampstart-nav-item, .ampstart-sidebar .ampstart-social-follow {
  margin: 0 0 2rem; }

.ampstart-sidebar .ampstart-nav-dropdown {
  margin: 0; }

.ampstart-sidebar .ampstart-navbar-trigger {
  line-height: inherit; }

.ampstart-navbar-trigger svg {
  pointer-events: none; }

.ampstart-related-article-section {
  border-color: #4a4a4a; }

.ampstart-related-article-section .ampstart-heading {
  color: #4a4a4a;
  font-weight: 400; }

.ampstart-related-article-readmore {
  color: #ff6f00;
  letter-spacing: 0; }

.ampstart-related-section-items > li {
  border-bottom: 1px solid #4a4a4a; }

.ampstart-related-section-items > li:last-child {
  border: none; }

.ampstart-related-section-items .ampstart-image-with-caption {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
  flex-wrap: wrap;
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  margin-bottom: 0; }

.ampstart-related-section-items .ampstart-image-with-caption > amp-img, .ampstart-related-section-items .ampstart-image-with-caption > figcaption {
  -webkit-box-flex: 1;
  -ms-flex: 1;
  flex: 1; }

.ampstart-related-section-items .ampstart-image-with-caption > figcaption {
  padding-left: 1rem; }

@media (min-width: 40.06rem) {
  .ampstart-related-section-items > li {
    border: none; }

  .ampstart-related-section-items .ampstart-image-with-caption > figcaption {
    padding: 1rem 0; }

  .ampstart-related-section-items .ampstart-image-with-caption > amp-img, .ampstart-related-section-items .ampstart-image-with-caption > figcaption {
    -ms-flex-preferred-size: 100%;
    flex-basis: 100%; } }
.ampstart-social-box {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex; }

.ampstart-social-box > amp-social-share {
  background-color: #ff6f00; }

.ampstart-icon {
  fill: #ff6f00; }

.related {
  background-color: #f5f5f5;
  margin: 1rem;
  display: flex;
  color: #111;
  padding: 0;
  box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.14), 0 1px 1px -1px rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12);
  text-decoration: none; }

.related > span {
  font-weight: 400;
  margin: 8px; }

.related:hover {
  background-color: #ccc; }

#banner {
  display: flex;
  width: 100%;
  justify-content: center;
  align-items: center; }

#banner > #banner-logo {
  padding: 8px; }

#banner > #banner-text {
  flex: 1;
  font-size: 14px;
  padding: 0 8px; }

#radhakrishna {
  display: inline-flex; }

.hanumanchalisa {
  margin-bottom: 5rem; }

p {
  margin-bottom: 2rem; }

h1, h2, h3, h4, h5, h6 {
  margin-bottom: 1.5rem; }

amp-img {
  margin-bottom: 2rem; }

.author-thumb {
  width: 24px;
  height: 24px;
  float: left;
  margin-right: 9px;
  border-radius: 100%; }

.author-thumb-post {
  width: 100px;
  height: 100px;
  float: left;
  margin-right: 9px;
  border-radius: 100%; }

.post-date {
  display: inline-block;
  margin-left: 8px;
  padding-left: 12px;
  border-left: #d5dbde 1px solid;
  text-transform: uppercase;
  font-size: 14px;
  white-space: nowrap; }

.newer-posts {
  right: 0; }

.older-posts {
  left: 0; }

.newer-posts {
  margin-right: 2rem;
  display: inline-block;
  padding: 0 15px;
  border: #bfc8cd 1px solid;
  text-decoration: none;
  border-radius: 4px;
  transition: border 0.3s ease; }

.older-posts {
  margin-left: 2rem;
  display: inline-block;
  padding: 0 15px;
  border: #bfc8cd 1px solid;
  text-decoration: none;
  border-radius: 4px;
  transition: border 0.3s ease; }

hr {
  color: #9e9e9e; }

dl dd {
  padding-left: 0.5rem; }

table {
  border-collapse: collapse;
  width: 100%; }

th, td {
  text-align: left; }

tr:nth-child(odd), th {
  background-color: #f2f2f2; }

blockquote {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  margin: 1.75em 1.5rem 1.75em 0;
  padding: 0 0 0 2rem;
  border-left: #ff6f00 0.4em solid; }

blockquote {
  display: block; }

.recommended {
  text-align: center; }

.author {
  color: #ffffff; }

.author-name {
  margin-bottom: 0rem; }

.author-section {
  margin-top: 2rem; }

.hanuman {
  margin-top: 25vh;
  text-align: center;
  font-weight: 600;
  margin-bottom: 1rem;
  text-shadow: 0 2px 1px rgba(0, 0, 0, 0.67); }

.title {
  background: none; }

body > figure > figcaption > header > h2 {
  text-align: center; }

.description {
  font-size: 1.5rem;
  text-shadow: 0 2px 1px rgba(0, 0, 0, 0.67);
  background: none; }

.ampstart-read {
  color: #fff;
  margin-top: 5rem;
  padding-bottom: 3.5rem; }

.ampstart-read:after {
  display: block;
  content: "⌄";
  font-size: 2rem; }

.ampstart-read-text {
  background: #ff6f00; }

  </style>



  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  <script async src="https://cdn.ampproject.org/v0.js"></script>
  <script custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js" async=""></script>
  <script custom-element="amp-accordion" src="https://cdn.ampproject.org/v0/amp-accordion-0.1.js" async=""></script>
  <script custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js" async=""></script>
  <script async custom-element="amp-list" src="https://cdn.ampproject.org/v0/amp-list-0.1.js"></script>
  <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.1.js"></script>
  <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
  <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  <script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
  <script async custom-element="amp-audio" src="https://cdn.ampproject.org/v0/amp-audio-0.1.js"></script>
    
</head>

  <body>
    <!-- Start Navbar -->
  <header class="ampstart-headerbar fixed flex justify-start items-center top-0 left-0 right-0 pl2 pr4 ">
    <div role="button" aria-label="open sidebar" on="tap:header-sidebar.toggle" tabindex="0" class="ampstart-navbar-trigger  pr2  ">☰
    </div>
    
    <a class="my0 mx-auto" href="/"><amp-img src="/assets/images/logo_bear.png" width="110" height="33" layout="fixed" class="my0 mx-auto" alt="Logo"></amp-img></a>
    
  </header>


<!-- Start Sidebar -->
<amp-sidebar id="header-sidebar" class="ampstart-sidebar px3" layout="nodisplay">
  <div class="flex justify-start items-center ampstart-sidebar-header">
    <div role="button" aria-label="close sidebar" on="tap:header-sidebar.toggle" tabindex="0" class="ampstart-navbar-trigger items-start">✕</div>
  </div>
  <nav class="ampstart-sidebar-nav ampstart-nav">
    <ul class="list-reset m0 p0 ampstart-label">
        
            
      <li class="ampstart-nav-item ampstart-nav-dropdown relative current">
          <li class="ampstart-faq-item"><a href="https://t4k4.github.io//" class="text-decoration-none">Home</a></li>
      </li>
      
            
      <li class="ampstart-nav-item ampstart-nav-dropdown relative ">
          <li class="ampstart-faq-item"><a href="https://t4k4.github.io//about" class="text-decoration-none">About</a></li>
      </li>
      
    </ul>
  </nav>


  <ul class="ampstart-social-follow list-reset flex justify-around items-center flex-wrap m0 mb4">
    
    <li>
        <a href="https://twitter.com/twitter" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="22.2" viewbox="0 0 53 49"><title>Twitter</title><path d="M45 6.9c-1.6 1-3.3 1.6-5.2 2-1.5-1.6-3.6-2.6-5.9-2.6-4.5 0-8.2 3.7-8.2 8.3 0 .6.1 1.3.2 1.9-6.8-.4-12.8-3.7-16.8-8.7C8.4 9 8 10.5 8 12c0 2.8 1.4 5.4 3.6 6.9-1.3-.1-2.6-.5-3.7-1.1v.1c0 4 2.8 7.4 6.6 8.1-.7.2-1.5.3-2.2.3-.5 0-1 0-1.5-.1 1 3.3 4 5.7 7.6 5.7-2.8 2.2-6.3 3.6-10.2 3.6-.6 0-1.3-.1-1.9-.1 3.6 2.3 7.9 3.7 12.5 3.7 15.1 0 23.3-12.6 23.3-23.6 0-.3 0-.7-.1-1 1.6-1.2 3-2.7 4.1-4.3-1.4.6-3 1.1-4.7 1.3 1.7-1 3-2.7 3.6-4.6" class="ampstart-icon ampstart-icon-twitter"></path></svg></a>
    </li>
    
    
    <li>
        <a href="https://facebook.com/facebook" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="23.6" viewbox="0 0 56 55"><title>Facebook</title><path d="M47.5 43c0 1.2-.9 2.1-2.1 2.1h-10V30h5.1l.8-5.9h-5.9v-3.7c0-1.7.5-2.9 3-2.9h3.1v-5.3c-.6 0-2.4-.2-4.6-.2-4.5 0-7.5 2.7-7.5 7.8v4.3h-5.1V30h5.1v15.1H10.7c-1.2 0-2.2-.9-2.2-2.1V8.3c0-1.2 1-2.2 2.2-2.2h34.7c1.2 0 2.1 1 2.1 2.2V43" class="ampstart-icon ampstart-icon-fb"></path></svg></a>
    </li>
    
    
    <li>
        <a href="https://github.com/github" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML github"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 64 64"><path d="M22.4 1.4C-.8 9-7.4 38.4 10.5 54.9 14.7 58.8 20.4 62 23 62c.5 0 1-1.6 1-3.5 0-3.3-.2-3.5-3.5-3.5-3.5 0-4.2-.5-9-6.6-4.4-5.6-2.3-6.2 3.2-.9 4.2 4 7.5 4.5 9.8 1.2 1.4-2.1 1.4-2.2-.7-3-6-2.3-8.8-4.2-10.2-7.2-2.1-4.3-2.1-12.4 0-15.3.8-1.2 1.2-2.7.9-3.2-1-1.6.5-7 1.8-7 .7 0 2.4.6 3.8 1.4 1.7.9 6 1.4 11.9 1.4s10.2-.5 11.9-1.4c1.4-.8 3.1-1.4 3.8-1.4 1.3 0 2.8 5.4 1.8 7-.3.5.1 2 .9 3.2 1.8 2.5 2.1 10.3.7 14.1-1.4 3.6-5 6.6-9.3 7.8-3.3.9-3.7 1.2-2.8 2.9.5 1 1 4.6 1 7.9 0 3.5.4 6.1 1 6.1 5.2 0 15.8-8.8 19.8-16.5 2.3-4.3 2.7-6.3 2.7-13.5 0-7-.4-9.4-2.4-13.5C57.9 12.2 51.8 6 45.6 3 39.6.2 28.5-.6 22.4 1.4z" class="ampstart-icon ampstart-icon-github"/></svg></a>
    </li>
    
  </ul>

  <ul class="ampstart-sidebar-faq list-reset m0">
  
    <li class="ampstart-faq-item"><a href="/contact" class="text-decoration-none">Contact</a></li>
  
  
    <li class="ampstart-faq-item"><a href="/privacy-policy" class="text-decoration-none">Privacy Policy</a></li>
  
  </ul>
</amp-sidebar>


      

    <main id="content" role="main" class="">
      <article class="recipe-article">
        <header>
          
          <span class="ampstart-subtitle block px3 pt2 mb2">
                        
                            
                               <a href='/tags/#CTF'>Ctf</a>,
                            
                        
                            
                               <a href='/tags/#reverse engineering'>Reverse engineering</a>,
                            
                        
                            
                               <a href='/tags/#WriteUp'>Writeup</a>
                            
                        
          </span>
          
          <h1 class="mb1 px3">WhiteHat 2018 WP</h1>

          <address class="ampstart-byline clearfix mb4 px3 h5">
            <time class="ampstart-byline-pubdate block bold my1" datetime="18 January 2020">18 January 2020</time>
          </address>
        </header>

  

    <div class="px3 mb4">
      <h4 id="re01">re01</h4>

<blockquote>
  <p>No hint.</p>
</blockquote>

<blockquote>
  <p>WriteUp: This challenge is pretty straight forward asks for a key and gives us a flag.</p>
</blockquote>

<p>直接运行WhiteHat.exe，没有任何提示
于是丢到OD里，对<code class="highlighter-rouge">GetWindowTextA</code>下断，可以找到函数<code class="highlighter-rouge">sub_40199B</code>：</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">sub_40199B</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// eax@1
</span>  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// eax@2
</span>  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [sp+8h] [bp-11Ch]@1
</span>  <span class="kt">char</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [sp+Ch] [bp-118h]@1
</span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [sp+Dh] [bp-117h]@1
</span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [sp+120h] [bp-4h]@1
</span>
  <span class="n">v0</span> <span class="o">=</span> <span class="n">sub_406250</span><span class="p">();</span>
  <span class="n">unknown_libname_52</span><span class="p">(</span><span class="n">v0</span><span class="p">);</span>
  <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xF9u</span><span class="p">);</span>
  <span class="n">CWnd</span><span class="o">::</span><span class="n">GetWindowTextA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v2</span><span class="p">);</span>                    <span class="c1">// bp here
</span>  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">-</span> <span class="mi">12</span><span class="p">)</span> <span class="o">==</span> <span class="mi">16</span> <span class="p">)</span>             <span class="c1">// string length is 16
</span>  <span class="p">{</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">ATL</span><span class="o">::</span><span class="n">CSimpleStringT</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="mi">0</span><span class="o">&gt;::</span><span class="n">GetBuffer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v2</span><span class="p">);</span><span class="c1">// v1指向输入字符串
</span>    <span class="n">sub_40138F</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v3</span><span class="p">);</span>                        <span class="c1">// 如果字符串长度等于16，则进入字符串处理函数sub_40138F
</span>  <span class="p">}</span>
  <span class="n">ATL</span><span class="o">::</span><span class="n">CStringData</span><span class="o">::</span><span class="n">Release</span><span class="p">((</span><span class="n">ATL</span><span class="o">::</span><span class="n">CStringData</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">-</span> <span class="mi">16</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>
<p>根据函数<code class="highlighter-rouge">sub_40138F</code>可以得到正确的输入:</p>
<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">signed</span> <span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">sub_40138F</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v27</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x83u</span><span class="p">,</span><span class="mh">0xF9u</span><span class="p">,</span><span class="mh">0x81u</span><span class="p">,</span><span class="mh">0xE8u</span><span class="p">,</span><span class="mh">0x87u</span><span class="p">,</span><span class="mh">0xE9u</span><span class="p">,</span><span class="mh">0x85u</span><span class="p">,</span><span class="mh">0xAAu</span><span class="p">,</span>
        <span class="mh">0x8Bu</span><span class="p">,</span><span class="mh">0xFAu</span><span class="p">,</span><span class="mh">0x8Eu</span><span class="p">,</span><span class="mh">0xC4u</span><span class="p">,</span><span class="mh">0x8Du</span><span class="p">,</span><span class="mh">0xF3u</span><span class="p">,</span><span class="mh">0x93u</span><span class="p">,</span><span class="mh">0xF2u</span><span class="p">};</span> <span class="c1">// [sp+4Ch] [bp-14h]@1
</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="n">input</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>

  <span class="n">GetNativeSystemInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SystemInfo</span><span class="p">);</span>
  <span class="n">GetLocalTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SystemTime</span><span class="p">);</span>                    <span class="c1">// SystemTime: Sat. 8.18.2018
</span>  <span class="n">GetLocaleInfoA</span><span class="p">(</span><span class="mh">0x400u</span><span class="p">,</span> <span class="mh">0x20001009u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">LCData</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="n">v4</span><span class="p">)</span> <span class="o">==</span> <span class="sc">'K'</span> <span class="p">)</span>          <span class="c1">// input[11] == 'K'
</span>  <span class="p">{</span>                                             <span class="c1">// 实际上只有一次循环
</span>    <span class="n">v4</span> <span class="o">+=</span> <span class="mi">7</span><span class="p">;</span>
    <span class="n">v26</span> <span class="o">=</span> <span class="n">v4</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">&gt;=</span> <span class="mi">16</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v3</span> <span class="o">=</span> <span class="n">byte_438A0C</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">byte_438A0C</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">byte_438A0C</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">byte_438A0C</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="n">byte_438A0C</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>     <span class="c1">// v3 = "abcdefghiklmopqx"
</span>      <span class="n">v5</span> <span class="o">=</span> <span class="n">input</span><span class="p">;</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
      <span class="n">v7</span> <span class="o">=</span> <span class="n">input</span> <span class="o">-</span> <span class="n">v3</span><span class="p">;</span>                          <span class="c1">// v7为两个字符串(v3和input)地址的差值
</span>                                                <span class="c1">// index based on v7, 实际上是input
</span>      <span class="n">v8</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
      <span class="k">do</span>
      <span class="p">{</span>
        <span class="o">*</span><span class="n">v6</span> <span class="o">^=</span> <span class="n">v6</span><span class="p">[</span><span class="n">v7</span><span class="p">];</span>
        <span class="n">v6</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="o">--</span><span class="n">v8</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">while</span> <span class="p">(</span> <span class="n">v8</span> <span class="p">);</span>                             <span class="c1">// 两个字符为一组，将v3每组第二个字符与input每组第二个字符异或
</span>      <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v3</span><span class="p">;</span>
      <span class="n">v10</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
      <span class="k">do</span>
      <span class="p">{</span>
        <span class="n">v9</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">=</span> <span class="n">LOBYTE</span><span class="p">(</span><span class="n">SystemTime</span><span class="p">.</span><span class="n">wDay</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="o">*</span><span class="n">v9</span> <span class="o">+</span> <span class="n">v9</span><span class="p">[</span><span class="n">v7</span><span class="p">]);</span><span class="c1">// 
</span>                                                <span class="c1">// input[i] = LOBYTE(SystemTime.wDay) ^ (v3[i] + input[i]);
</span>                                                <span class="c1">// or 
</span>                                                <span class="c1">// input[i] = 0x12 ^ (v3[i] + input[i]);
</span>        <span class="o">*</span><span class="n">v9</span><span class="o">++</span> <span class="o">^=</span> <span class="n">LOBYTE</span><span class="p">(</span><span class="n">SystemTime</span><span class="p">.</span><span class="n">wYear</span><span class="p">);</span>      <span class="c1">// 
</span>                                                <span class="c1">// v3[i] ^= LOBYTE(SystemTime.wYear);
</span>                                                <span class="c1">// or 
</span>                                                <span class="c1">// v3[i] ^= 0xe2;
</span>        <span class="o">--</span><span class="n">v10</span><span class="p">;</span>                                  <span class="c1">// ++i;
</span>      <span class="p">}</span>
      <span class="k">while</span> <span class="p">(</span> <span class="n">v10</span> <span class="p">);</span>                            <span class="c1">// while(i&lt;16)
</span>      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v5</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+=</span> <span class="n">LOBYTE</span><span class="p">(</span><span class="n">SystemTime</span><span class="p">.</span><span class="n">wDayOfWeek</span><span class="p">);</span><span class="c1">// 
</span>                                                <span class="c1">// input[16] += LOBYTE(SystemTime.wDayOfWeek)
</span>                                                <span class="c1">// or 
</span>                                                <span class="c1">// input[16] += 0x6
</span>      <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v27</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">v3</span> <span class="o">-</span> <span class="p">(</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)</span><span class="n">v27</span><span class="p">)</span> <span class="o">==</span> <span class="n">v27</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span><span class="c1">// 字符判断: v27[i] == v3[i]
</span>      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">++</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">16</span> <span class="p">)</span>                        <span class="c1">// length: 16
</span>        <span class="p">{</span>
          <span class="n">v12</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">do</span>
          <span class="p">{</span>
            <span class="n">v26</span> <span class="o">+=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v3</span> <span class="o">+</span> <span class="n">v12</span><span class="p">);</span>
            <span class="n">v12</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">while</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&lt;</span> <span class="mi">16</span> <span class="p">);</span>
          <span class="n">v13</span> <span class="o">=</span> <span class="n">FindResourceA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">LPCSTR</span><span class="p">)</span><span class="mh">0x86</span><span class="p">,</span> <span class="s">"EXE"</span><span class="p">);</span><span class="c1">// a HTML document
</span>          <span class="n">GetLastError</span><span class="p">();</span>
          <span class="n">v14</span> <span class="o">=</span> <span class="n">LoadResource</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v13</span><span class="p">);</span>
          <span class="n">v15</span> <span class="o">=</span> <span class="n">LockResource</span><span class="p">(</span><span class="n">v14</span><span class="p">);</span>
          <span class="n">v16</span> <span class="o">=</span> <span class="n">SizeofResource</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v13</span><span class="p">);</span>
          <span class="n">v17</span> <span class="o">=</span> <span class="n">v16</span><span class="p">;</span>
          <span class="n">v18</span> <span class="o">=</span> <span class="n">sub_4010FC</span><span class="p">(</span><span class="n">v16</span><span class="p">);</span>                <span class="c1">// 使(v16+x)能被3整除(x取0, 1, 2)
</span>                                                <span class="c1">// 返回(v16+x)*4/3
</span>          <span class="n">v19</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">v18</span> <span class="o">+</span> <span class="mi">50</span><span class="p">);</span>
          <span class="n">v20</span> <span class="o">=</span> <span class="n">v19</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v19</span> <span class="o">||</span> <span class="p">(</span><span class="n">sub_401000</span><span class="p">(</span><span class="n">v19</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v15</span><span class="p">,</span> <span class="n">v17</span><span class="p">),</span> <span class="p">(</span><span class="n">result</span> <span class="o">=</span> <span class="n">sub_40111D</span><span class="p">(</span><span class="n">v26</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v20</span><span class="p">[</span><span class="mi">350000</span><span class="p">]</span> <span class="o">+</span> <span class="mi">192</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span><span class="c1">// 
</span>                                                <span class="c1">// sub_401000: 输入无关(?)
</span>                                                <span class="c1">// 以上这段都可以忽略，重点是函数sub_40111D
</span>                                                <span class="c1">// bp here
</span>            <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>脚本：</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sec</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xF9</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0xE8</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0xE9</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0xAA</span><span class="p">,</span><span class="mh">0x8B</span><span class="p">,</span><span class="mh">0xFA</span><span class="p">,</span><span class="mh">0x8E</span><span class="p">,</span><span class="mh">0xC4</span><span class="p">,</span><span class="mh">0x8D</span><span class="p">,</span><span class="mh">0xF3</span><span class="p">,</span><span class="mh">0x93</span><span class="p">,</span><span class="mh">0xF2</span><span class="p">]</span>
<span class="n">v3</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s">"abcdefghiklmopqx"</span><span class="p">]</span>

<span class="s">'''original:

input_str = [ord(c) for c in "asdfasfdasdfasdf"]
for i in range(1, len(v3), 2):
    v3[i] ^= input_str[i]

for i in range(16):
    input_str[i] = (v3[i] + input_str[i]) ^ 0x12
    v3[i] ^= 0xe2
'''</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sec</span><span class="p">)):</span>
    <span class="n">sec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0xe2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sec</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">sec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sec</span><span class="p">]))</span>
</code></pre></div></div>
<p>可以得到key： <code class="highlighter-rouge">aycnemg islKoaqh</code> (<strong>比赛时做到了这一步</strong>)</p>

<blockquote>
  <p>WriteUp: After entering the correct key. The executable drop two files named 2.exe and b.dll in %temp% folder (sub_40111D) and runs the 2.exe using CreateProcessA with “564” as CLA(command line arguments).
After analyzing 2.exe we see that it checks for the parent process ID and must be named to “WhiteHat” if this so it drops the flag.dll in %temp% folder.
But wait this flag.dll is not actually a PE file. By seeing it’s header we get that it is an PNG file. By changing the extension to .png we get our flag.</p>
</blockquote>

<p>函数<code class="highlighter-rouge">sub_40111D</code>:</p>
<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">signed</span> <span class="kt">int</span> <span class="kr">__stdcall</span> <span class="nf">sub_40111D</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">HGLOBAL</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// eax@1
</span>  <span class="n">HRSRC</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// eax@1
</span>  <span class="n">HRSRC</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// esi@1
</span>  <span class="n">HGLOBAL</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// eax@1
</span>  <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">v5</span><span class="p">;</span> <span class="c1">// edi@1
</span>  <span class="n">HANDLE</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// esi@1
</span>  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// ecx@1
</span>  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// eax@3
</span>  <span class="k">struct</span> <span class="n">_STARTUPINFOA</span> <span class="n">StartupInfo</span><span class="p">;</span> <span class="c1">// [sp+Ch] [bp-80h]@5
</span>  <span class="n">DWORD</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [sp+50h] [bp-3Ch]@1
</span>  <span class="n">DWORD</span> <span class="n">NumberOfBytesWritten</span><span class="p">;</span> <span class="c1">// [sp+54h] [bp-38h]@1
</span>  <span class="k">struct</span> <span class="n">_PROCESS_INFORMATION</span> <span class="n">ProcessInformation</span><span class="p">;</span> <span class="c1">// [sp+58h] [bp-34h]@5
</span>  <span class="n">LPCVOID</span> <span class="n">lpBuffer</span><span class="p">;</span> <span class="c1">// [sp+68h] [bp-24h]@1
</span>  <span class="n">HANDLE</span> <span class="n">hObject</span><span class="p">;</span> <span class="c1">// [sp+6Ch] [bp-20h]@1
</span>  <span class="n">HRSRC</span> <span class="n">hResInfo</span><span class="p">;</span> <span class="c1">// [sp+70h] [bp-1Ch]@1
</span>  <span class="kt">char</span> <span class="n">v17</span><span class="p">;</span> <span class="c1">// [sp+74h] [bp-18h]@1
</span>  <span class="kt">char</span> <span class="n">v18</span><span class="p">;</span> <span class="c1">// [sp+75h] [bp-17h]@1
</span>  <span class="kt">char</span> <span class="n">v19</span><span class="p">;</span> <span class="c1">// [sp+98h] [bp+Ch]@1
</span>  <span class="n">CHAR</span> <span class="n">Buffer</span><span class="p">;</span> <span class="c1">// [sp+178h] [bp+ECh]@1
</span>  <span class="kt">char</span> <span class="n">v21</span><span class="p">;</span> <span class="c1">// [sp+179h] [bp+EDh]@1
</span>  <span class="n">CHAR</span> <span class="n">FileName</span><span class="p">;</span> <span class="c1">// [sp+27Ch] [bp+1F0h]@1
</span>  <span class="kt">char</span> <span class="n">v23</span><span class="p">;</span> <span class="c1">// [sp+27Dh] [bp+1F1h]@1
</span>  <span class="n">CHAR</span> <span class="n">CommandLine</span><span class="p">;</span> <span class="c1">// [sp+380h] [bp+2F4h]@5
</span>  <span class="kt">char</span> <span class="n">v25</span><span class="p">;</span> <span class="c1">// [sp+381h] [bp+2F5h]@5
</span>  <span class="kt">int</span> <span class="n">v26</span><span class="p">;</span> <span class="c1">// [sp+3E4h] [bp+358h]@3
</span>  <span class="kt">int</span> <span class="n">v27</span><span class="p">;</span> <span class="c1">// [sp+3E8h] [bp+35Ch]@3
</span>  <span class="kt">int</span> <span class="n">v28</span><span class="p">;</span> <span class="c1">// [sp+3ECh] [bp+360h]@3
</span>
  <span class="n">Buffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v21</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x103u</span><span class="p">);</span>
  <span class="n">FileName</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v23</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x103u</span><span class="p">);</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x103u</span><span class="p">);</span>
  <span class="n">GetTempPathA</span><span class="p">(</span><span class="mh">0x104u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Buffer</span><span class="p">);</span>
  <span class="n">GetTempPathA</span><span class="p">(</span><span class="mh">0x104u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">FileName</span><span class="p">);</span>
  <span class="n">strcat_s</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">,</span> <span class="mh">0x104u</span><span class="p">,</span> <span class="s">"b.dll"</span><span class="p">);</span> <span class="c1">// 文件路径
</span>  <span class="n">strcat_s</span><span class="p">(</span><span class="o">&amp;</span><span class="n">FileName</span><span class="p">,</span> <span class="mh">0x104u</span><span class="p">,</span> <span class="s">"2.exe"</span><span class="p">);</span> <span class="c1">// 文件路径
</span>  <span class="n">hResInfo</span> <span class="o">=</span> <span class="n">FindResourceA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">LPCSTR</span><span class="p">)</span><span class="mh">0x8D</span><span class="p">,</span> <span class="s">"SYS"</span><span class="p">);</span>
  <span class="n">GetLastError</span><span class="p">();</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="n">LoadResource</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hResInfo</span><span class="p">);</span>
  <span class="n">lpBuffer</span> <span class="o">=</span> <span class="n">LockResource</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
  <span class="n">hResInfo</span> <span class="o">=</span> <span class="p">(</span><span class="n">HRSRC</span><span class="p">)</span><span class="n">SizeofResource</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hResInfo</span><span class="p">);</span>
  <span class="n">hObject</span> <span class="o">=</span> <span class="n">CreateFileA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">FileName</span><span class="p">,</span> <span class="mh">0x10000000u</span><span class="p">,</span> <span class="mi">1u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2u</span><span class="p">,</span> <span class="mh">0x80u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span><span class="c1">// create file %TEMP%\2.exe
</span>  <span class="n">WriteFile</span><span class="p">(</span><span class="n">hObject</span><span class="p">,</span> <span class="n">lpBuffer</span><span class="p">,</span> <span class="p">(</span><span class="n">DWORD</span><span class="p">)</span><span class="n">hResInfo</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">NumberOfBytesWritten</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">CloseHandle</span><span class="p">(</span><span class="n">hObject</span><span class="p">);</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">FindResourceA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">LPCSTR</span><span class="p">)</span><span class="mh">0x8E</span><span class="p">,</span> <span class="s">"SYS"</span><span class="p">);</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="n">v2</span><span class="p">;</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">LoadResource</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v2</span><span class="p">);</span>
  <span class="n">v5</span> <span class="o">=</span> <span class="n">LockResource</span><span class="p">(</span><span class="n">v4</span><span class="p">);</span>
  <span class="n">hObject</span> <span class="o">=</span> <span class="p">(</span><span class="n">HANDLE</span><span class="p">)</span><span class="n">SizeofResource</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="n">CreateFileA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">,</span> <span class="mh">0x10000000u</span><span class="p">,</span> <span class="mi">1u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2u</span><span class="p">,</span> <span class="mh">0x80u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span><span class="c1">// create file %TEMP%\b.dll
</span>  <span class="n">WriteFile</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">v5</span><span class="p">,</span> <span class="p">(</span><span class="n">DWORD</span><span class="p">)</span><span class="n">hObject</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v11</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">CloseHandle</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
  <span class="n">qmemcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v17</span><span class="p">,</span> <span class="s">"qa</span><span class="se">\"</span><span class="s">apgcvg</span><span class="se">\"</span><span class="s">Rv</span><span class="se">\"</span><span class="s">v{rg?</span><span class="se">\"</span><span class="s">dkngq{q</span><span class="se">\"</span><span class="s">`klRcvj?</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span> <span class="mh">0x24u</span><span class="p">);</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v19</span> <span class="o">=</span> <span class="n">aQaApgcvgRvVRg_</span><span class="p">[</span><span class="mi">36</span><span class="p">];</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v17</span> <span class="o">+</span> <span class="n">v7</span><span class="p">)</span> <span class="o">^=</span> <span class="n">a1</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
    <span class="o">++</span><span class="n">v7</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v7</span> <span class="o">&lt;</span> <span class="mi">36</span> <span class="p">);</span>
  <span class="n">v26</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="s">"p`#pwbqw#Sw"</span><span class="p">;</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="s">"wbqw#Sw"</span><span class="p">;</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v28</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="s">"#Sw"</span><span class="p">;</span>
  <span class="k">do</span>
    <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v26</span> <span class="o">+</span> <span class="n">v8</span><span class="o">++</span><span class="p">)</span> <span class="o">^=</span> <span class="p">(</span><span class="n">_BYTE</span><span class="p">)</span><span class="n">a1</span> <span class="o">-</span> <span class="mi">47</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&lt;</span> <span class="mi">11</span> <span class="p">);</span>
  <span class="n">CommandLine</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x63u</span><span class="p">);</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">CommandLine</span><span class="p">,</span> <span class="s">"%d"</span><span class="p">,</span> <span class="n">a1</span><span class="p">);</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">StartupInfo</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x44u</span><span class="p">);</span>
  <span class="n">StartupInfo</span><span class="p">.</span><span class="n">cb</span> <span class="o">=</span> <span class="mi">68</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">CreateProcessA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">FileName</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">CommandLine</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">StartupInfo</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ProcessInformation</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// run 2.exe with CommandLine as argument, which is "564"(dumped) according to function sub_40128F
</span>  <span class="p">{</span>
    <span class="n">WaitForSingleObject</span><span class="p">(</span><span class="n">ProcessInformation</span><span class="p">.</span><span class="n">hProcess</span><span class="p">,</span> <span class="mh">0xFFFFFFFF</span><span class="p">);</span>
    <span class="n">CloseHandle</span><span class="p">(</span><span class="n">ProcessInformation</span><span class="p">.</span><span class="n">hThread</span><span class="p">);</span>
    <span class="n">CloseHandle</span><span class="p">(</span><span class="n">ProcessInformation</span><span class="p">.</span><span class="n">hProcess</span><span class="p">);</span>
    <span class="n">DeleteFileA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">);</span>
    <span class="n">DeleteFileA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">FileName</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>最终在%TEMP%文件夹下可以得到三个文件：<code class="highlighter-rouge">b.dll</code>，<code class="highlighter-rouge">a.exe</code>，<code class="highlighter-rouge">flag.dll</code>。
<code class="highlighter-rouge">file</code>查看flag.dll文件头，可以发现是个PNG文件。</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file flag.dll
flag.dll: PNG image data, 560 x 217, 8-bit/color RGB, non-interlaced
</code></pre></div></div>
<p>更改扩展名，打开图片即可看到flag:
<code class="highlighter-rouge">flag is: today is good day</code></p>

<hr />
<h4 id="re03---380p">re03 - 380p</h4>
<blockquote>
  <p>No hint.</p>
</blockquote>

<p>直接运行<code class="highlighter-rouge">DebugMe.exe</code>，发现是输入key然后进行验证。
用OD对<code class="highlighter-rouge">GetWindowText</code>下断，断在函数<code class="highlighter-rouge">sub_40BFA9</code>，查看对该函数的引用，可以发现程序大致流程如下：</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-----+     +------------+     +----------------+      +----------------+
| ... | <span class="nt">--</span><span class="o">&gt;</span> | sub_4029C0 | <span class="nt">--</span><span class="o">&gt;</span> |   sub_40BFA9   | <span class="nt">---</span><span class="o">&gt;</span> | GetWindowTextW |
+-----+     +------------+     +----------------+  |   +----------------+
              |                                    |
              | validate                           |
              v                                    v
            +------------+             +----------------------+
            | sub_402BB0 |             | GetWindowTextLengthW |
            +------------+             +----------------------+
</code></pre></div></div>

<p><code class="highlighter-rouge">sub_4029C0</code>:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">__thiscall</span> <span class="nf">sub_4029C0</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">this</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="n">this</span><span class="p">;</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">sub_404C10</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">word_5AAA50</span><span class="p">);</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">sub_40BFA9</span><span class="p">((</span><span class="kt">int</span><span class="p">)(</span><span class="n">v1</span> <span class="o">+</span> <span class="mh">0xAC</span><span class="p">),</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">);</span>      <span class="c1">// read window text to v13
</span>  <span class="n">v2</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">word_5AAA50</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="o">*</span><span class="n">v2</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">v2</span> <span class="o">!=</span> <span class="o">*</span><span class="n">v3</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v2</span> <span class="p">)</span>
      <span class="k">goto</span> <span class="n">LABEL_6</span><span class="p">;</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">&lt;</span> <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="o">!=</span> <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">v2</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">v3</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v5</span> <span class="p">)</span>
    <span class="p">{</span>
<span class="nl">LABEL_6:</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_8</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="o">-</span><span class="n">v4</span> <span class="o">|</span> <span class="mi">1</span><span class="p">;</span>
<span class="nl">LABEL_8:</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">MessageBoxW</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">L"Key is empty!"</span><span class="p">,</span> <span class="s">L"Notify"</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v3</span><span class="p">;</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v11</span><span class="p">;</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v11</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">sub_402BB0</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="n">v11</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// 显然，该函数为验证函数, v11为输入字符串
</span>      <span class="n">MessageBoxW</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">L"Success: Key is correct!"</span><span class="p">,</span> <span class="s">L"Notify"</span><span class="p">,</span> <span class="mh">0x40u</span><span class="p">);</span>
    <span class="k">else</span>
      <span class="n">MessageBoxW</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">L"Key is NOT correct!"</span><span class="p">,</span> <span class="s">L"Notify"</span><span class="p">,</span> <span class="mh">0x10u</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">-</span> <span class="mi">8</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">_InterlockedDecrement</span><span class="p">((</span><span class="k">volatile</span> <span class="kt">signed</span> <span class="kr">__int32</span> <span class="o">*</span><span class="p">)</span><span class="n">v13</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">result</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v8</span><span class="p">;</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v8</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="kr">__stdcall</span> <span class="o">**</span><span class="p">)(</span><span class="n">OLECHAR</span> <span class="o">*</span><span class="p">))(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v10</span> <span class="o">+</span> <span class="mi">4</span><span class="p">))(</span><span class="n">v8</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">sub_402BB0</code>:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">signed</span> <span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">sub_402BB0</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">v82</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="n">a1</span><span class="p">;</span>
  <span class="n">v91</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">input</span> <span class="o">-</span> <span class="mi">12</span><span class="p">);</span> <span class="c1">// input length
</span>  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">)</span>  <span class="k">goto</span> <span class="n">fail1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="p">)</span>  <span class="k">goto</span> <span class="n">LABEL_7</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>         <span class="c1">// strcpy
</span>  <span class="n">sub_404010</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>  <span class="c1">// 字符串处理
</span>                                <span class="c1">// 将"dvfrhtgbPr"的前9位替换为v81前9位对应位置值+3
</span>                                <span class="c1">// 伪：
</span>                                <span class="c1">// string = "dvfrhtgbPr"
</span>                                <span class="c1">// string[i] = v81[i] + 3 for i in range(9)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">);</span>   <span class="c1">// strcpy
</span>  <span class="n">sub_404010</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>  <span class="c1">// 字符串处理，将上一步得到的sub1字符串做相同的处理
</span>                                <span class="c1">// 或者说，这两步操作等价于：（伪）
</span>                                <span class="c1">// string = "dvfrhtgbPr"
</span>                                <span class="c1">// string[i] = v81[i] + 6 for i in range(9)
</span>  <span class="n">a1</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="n">wcscmp</span><span class="p">(</span><span class="n">sub2</span><span class="p">,</span> <span class="s">L"wiergrrrrrrfwefi"</span><span class="p">);</span>
  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">a1</span> <span class="p">)</span>                    <span class="c1">// ******* fail if equal *******
</span>  <span class="p">{</span>
<span class="nl">fail7:</span>
    <span class="cm">/* ... */</span>
    <span class="k">goto</span> <span class="n">fail1</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nl">LABEL_15:</span>
  <span class="cm">/* ... */</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&gt;=</span> <span class="mi">55</span> <span class="p">);</span> <span class="c1">// 字符串长度&gt;=55, 直接陷入死循环
</span>    <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
    <span class="n">sub_404010</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// string = "dvfrhtgbPr"
</span>                                 <span class="c1">// string[i] = v81[i] + 3 for i in range(9)
</span>    <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
    <span class="n">sub_404100</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// string = "dvfrhtgbPr"
</span>                                 <span class="c1">// string[i] = v81[i+10] for i in range(9)
</span>    <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
    <span class="n">sub_404200</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub3</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// string = "rfdeswe32f"
</span>                                 <span class="c1">// string[i] = v81[i+20] for i in range(9)
</span>    <span class="n">v3</span> <span class="o">+=</span> <span class="mi">50</span><span class="p">;</span>                    
    <span class="n">v14</span> <span class="o">=</span> <span class="n">wcscmp</span><span class="p">(</span><span class="n">sub2</span><span class="p">,</span> <span class="s">L"wiergrrrrrrfwefi"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v14</span> <span class="p">)</span> <span class="k">goto</span> <span class="n">fail2</span><span class="p">;</span>      <span class="c1">// ******* fail if equal *******
</span>    <span class="n">a1</span> <span class="o">=</span> <span class="n">sub1</span><span class="p">;</span>
    <span class="n">v15</span> <span class="o">=</span> <span class="s">L"efffffe3f"</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="c1">// 这里是一个字符串比较
</span>    <span class="p">{</span>
      <span class="n">v16</span> <span class="o">=</span> <span class="o">*</span><span class="n">a1</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">v15</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">a1</span> <span class="o">!=</span> <span class="o">*</span><span class="n">v15</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">a1</span> <span class="p">)</span>
        <span class="k">goto</span> <span class="n">fail5</span><span class="p">;</span>
      <span class="n">v17</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="n">v16</span> <span class="o">=</span> <span class="n">v17</span> <span class="o">&lt;</span> <span class="n">v15</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v17</span> <span class="o">!=</span> <span class="n">v15</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="n">a1</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="n">v15</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v17</span> <span class="p">)</span>
      <span class="p">{</span>
<span class="nl">fail5:</span>
        <span class="n">v18</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">goto</span> <span class="n">fail4</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">v18</span> <span class="o">=</span> <span class="o">-</span><span class="n">v16</span> <span class="o">|</span> <span class="mi">1</span><span class="p">;</span>
<span class="nl">fail4:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v18</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
<span class="nl">fail2:</span>
      <span class="cm">/* ... */</span>
<span class="nl">fail3:</span>
      <span class="cm">/* ... */</span>
      <span class="k">goto</span> <span class="n">fail7</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="cm">/* ... */</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">!=</span> <span class="mi">100</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
<span class="nl">LABEL_7:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">v3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">52</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
      <span class="n">sub_404010</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>
      <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
      <span class="n">sub_404100</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub4</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
      <span class="n">v8</span> <span class="o">=</span> <span class="n">wcscmp</span><span class="p">(</span><span class="n">sub4</span><span class="p">,</span> <span class="s">L"wiergrrrrrrfwefi"</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="p">)</span> <span class="c1">// ******** if not equal ****** 
</span>      <span class="p">{</span>
        <span class="cm">/* ... */</span>
      <span class="p">}</span>
      <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v91</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
      <span class="n">v5</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">sub4</span> <span class="o">-</span> <span class="mi">8</span><span class="p">);</span>
      <span class="k">goto</span> <span class="n">fail3</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">// 这里看起来有点靠谱了
</span>  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">input</span> <span class="o">-</span> <span class="mi">12</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">40</span> <span class="o">||</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">input</span> <span class="o">+</span> <span class="mi">78</span><span class="p">)</span> <span class="o">!=</span> <span class="sc">'x'</span> <span class="p">)</span> <span class="c1">// 输入字符串长度不等于40 or 输入的最后一个字符not 'x'
</span>  <span class="p">{</span>
<span class="nl">fail1:</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">goto</span> <span class="n">LABEL_92</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404010</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>  <span class="c1">// string = "dvfrhtgbPr"
</span>                                <span class="c1">// string[i] = v81[i] + 3 for i in range(9)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404100</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>  <span class="c1">// string = "dvfrhtgbPr"
</span>                                <span class="c1">// string[i] = v81[i+10] for i in range(9)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404200</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub3</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>  <span class="c1">// string = "rfdeswe32f"
</span>                                <span class="c1">// string[i] = v81[i+20] + 5 for i in range(9)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404310</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub4</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>  <span class="c1">// string = "bghtwsqsgr"
</span>                                <span class="c1">// string[i] = v81[i+30] + 3 for i in range(9)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404420</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v84</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>   <span class="c1">// string = "bghtwsqbghtwsqsgrsgr"
</span>                                <span class="c1">// string[i] = v81[i] + 3 for i in range(19)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404510</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v86</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>   <span class="c1">// string = "bghtwbghtwsqsgrsqsgr"
</span>                                <span class="c1">// string[i] = v81[i+20] + 3 for i in range(19)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">);</span>
  <span class="n">sub_404620</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v85</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span>   <span class="c1">// string = "bghtwsbghtwsqsgrqsgr"
</span>                                <span class="c1">// string[i] = v81[10+i] + 2 for i in range(19)
</span>  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">);</span>
  <span class="n">v33</span> <span class="o">=</span> <span class="n">sub_403420</span><span class="p">(</span><span class="n">v82</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] + 3 if i&amp;1 else v81[i] + 2
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">,</span> <span class="n">v33</span><span class="p">);</span> <span class="c1">// 最终结果存在sub1中
</span>  <span class="cm">/* ... */</span>
  <span class="n">v36</span> <span class="o">=</span> <span class="n">sub1</span><span class="p">;</span>
  <span class="n">v37</span> <span class="o">=</span> <span class="s">L"poskjyrvyr"</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="c1">// 这是一个字符串比较
</span>  <span class="p">{</span>
    <span class="n">v38</span> <span class="o">=</span> <span class="o">*</span><span class="n">v36</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">v37</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">v36</span> <span class="o">!=</span> <span class="o">*</span><span class="n">v37</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v36</span> <span class="p">)</span>
      <span class="k">goto</span> <span class="n">LABEL_49</span><span class="p">;</span>
    <span class="n">v39</span> <span class="o">=</span> <span class="n">v36</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">v38</span> <span class="o">=</span> <span class="n">v39</span> <span class="o">&lt;</span> <span class="n">v37</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v39</span> <span class="o">!=</span> <span class="n">v37</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="n">v36</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">v37</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v39</span> <span class="p">)</span>
    <span class="p">{</span>
<span class="nl">LABEL_49:</span>
      <span class="n">v40</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_51</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">v40</span> <span class="o">=</span> <span class="o">-</span><span class="n">v38</span> <span class="o">|</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v40</span> <span class="p">)</span>
    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
<span class="nl">LABEL_51:</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">);</span>
  <span class="n">v41</span> <span class="o">=</span> <span class="n">sub_4035D0</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] + 5 if i%5 else v81[i] + 9
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">,</span> <span class="n">v41</span><span class="p">);</span> <span class="c1">// 最终结果存在sub2中
</span>  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">,</span> <span class="s">L"j676kn|5nr"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// 字符串比较
</span>    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sub3</span><span class="p">);</span>
  <span class="n">v45</span> <span class="o">=</span> <span class="n">sub_403790</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] + 1 if i%4 else v81[i] + 3 
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub3</span><span class="p">,</span> <span class="n">v45</span><span class="p">);</span> <span class="c1">// 结果存在sub3中
</span>  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sub3</span><span class="p">,</span> <span class="s">L"uku|nokxqf"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">//字符串比较
</span>    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sub4</span><span class="p">);</span>
  <span class="n">v49</span> <span class="o">=</span> <span class="n">sub_403940</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] + 1 if i%3 else v91[i] + 2
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub4</span><span class="p">,</span> <span class="n">v49</span><span class="p">);</span> <span class="c1">// 结果存在sub4中
</span>  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub4</span><span class="p">,</span> <span class="s">L"dzihggh{er"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// 字符串比较
</span>    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v84</span><span class="p">);</span>
  <span class="n">v53</span> <span class="o">=</span> <span class="n">sub_403AF0</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] + 6 if i&amp;4 else v81[i] + 34
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v84</span><span class="p">,</span> <span class="n">v53</span><span class="p">);</span> <span class="c1">// 结果存在v84中
</span>  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v84</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="s">"</span><span class="se">\x90</span><span class="s">"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// 字符串比较
</span>    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v86</span><span class="p">);</span>
  <span class="n">v55</span> <span class="o">=</span> <span class="n">sub_403CA0</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] + 4 if i%5 else v81[i] + 18
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v86</span><span class="p">,</span> <span class="n">v55</span><span class="p">);</span> <span class="c1">// 结果存在v86中
</span>  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v86</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">*</span><span class="p">)</span><span class="s">"‚"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// 字符串比较
</span>    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v81</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v85</span><span class="p">);</span>
  <span class="n">v57</span> <span class="o">=</span> <span class="n">sub_403E60</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v83</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">v81</span><span class="p">);</span> <span class="c1">// v81[i] = v81[i] if i%4 else  v81[i] + 1
</span>  <span class="n">sub_404810</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v85</span><span class="p">,</span> <span class="n">v57</span><span class="p">);</span> <span class="c1">// 结果存在v85中
</span>  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int16</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v85</span><span class="p">,</span> <span class="s">L"d343igy2llogrxhkhtkr"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// 字符串比较
</span>    <span class="k">goto</span> <span class="n">fail6</span><span class="p">;</span>
  <span class="cm">/* ... */</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v86</span> <span class="o">+</span> <span class="mi">38</span><span class="p">)</span> <span class="o">==</span> <span class="mi">114</span> <span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">else</span>
<span class="nl">fail6:</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="cm">/* ... */</span>
<span class="nl">LABEL_92:</span>
  <span class="cm">/* ... */</span>
  <span class="k">return</span> <span class="n">flag</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>仔细查看函数可以发现，前面对字符串比较的处理是<code class="highlighter-rouge">相等则fail</code>，因此这段可以直接跳过，直接从<code class="highlighter-rouge">if ( *(_DWORD *)(input - 12) != 40 || *(_WORD *)(input + 78) != 'x' )</code>开始读。</p>

<p>字符串比较共有7处，分别为：
<code class="highlighter-rouge">sub_403420(sub_404010(input[0:10]))</code> vs <code class="highlighter-rouge">"poskjyrvyr"</code>
<code class="highlighter-rouge">sub_4035D0(sub_404100(input[10:20]))</code> vs <code class="highlighter-rouge">"j676kn|5nr"</code>
<code class="highlighter-rouge">sub_403790(sub_404200(input[20:30]))</code> vs <code class="highlighter-rouge">"uku|nokxqf"</code>
<code class="highlighter-rouge">sub_403940(sub_404310(input[30:40]))</code> vs <code class="highlighter-rouge">"dzihggh{er"</code>
<code class="highlighter-rouge">sub_403AF0(sub_404420(input[0:20]))</code> vs <code class="highlighter-rouge">"\x90\x72\x77\x6E\x8A\x7C\x76\x79\x99\x6D\x6A\x3A\x57\x3A\x6F\x6E\x9C\x39\x72\x72"</code>
<code class="highlighter-rouge">sub_403CA0(sub_404510(input[20:40]))</code> vs <code class="highlighter-rouge">"\x82\x6C\x76\x7D\x6D\x7E\x6C\x79\x70\x6C\x45\x7D\x6C\x6A\x6A\x78\x6A\x7E\x68\x72"</code>
<code class="highlighter-rouge">sub_403E60(sub_404620(inpupt[10:30]))</code> vs <code class="highlighter-rouge">"d343igy2llogrxhkhtkr"</code></p>

<p>分别对以上7个过程逆向，可以得到7个字符串<code class="highlighter-rouge">s1-s7</code>。由于对输入字符串的第一步处理并未利用每段输入的最后一个字符，所以逆向得到的7个字符串的最后一位都是不确定正确的。
容易分析得到，将<code class="highlighter-rouge">s5</code>和<code class="highlighter-rouge">s6</code>组合可以得到<code class="highlighter-rouge">key'</code>，其中第20和40个字符是不确定正确的；根据<code class="highlighter-rouge">s7</code>可以得到第20个字符；根据程序已知最后一个字符为<code class="highlighter-rouge">'x'</code>。</p>

<p>脚本：</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flag</span> <span class="o">=</span> <span class="s">''</span> 
<span class="n">string</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x90\x72\x77\x6E\x8A\x7C\x76\x79\x99\x6D\x6A\x3A\x57\x3A\x6F\x6E\x9C\x39\x72\x72</span><span class="s">"</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="p">[:</span><span class="mi">19</span><span class="p">]):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">-</span><span class="mi">6</span> <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">4</span> <span class="k">else</span> <span class="n">c</span><span class="o">-</span><span class="mi">34</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">+=</span> <span class="n">string</span><span class="p">[</span><span class="mi">19</span><span class="p">:]</span>

<span class="n">string</span> <span class="o">=</span> <span class="s">"</span><span class="se">\x82\x6C\x76\x7D\x6D\x7E\x6C\x79\x70\x6C\x45\x7D\x6C\x6A\x6A\x78\x6A\x7E\x68\x72</span><span class="s">"</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="p">[:</span><span class="mi">19</span><span class="p">]):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">-</span><span class="mi">4</span> <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">5</span> <span class="k">else</span> <span class="n">c</span><span class="o">-</span><span class="mi">18</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">+=</span> <span class="n">string</span><span class="p">[</span><span class="mi">19</span><span class="p">:]</span>

<span class="s">'''
flag_patch = '' # processing bytes[10:29]
string = 'd343igy2llogrxhkhtkr'
for (i, c) in enumerate(string[:19]):
    c = ord(c)
    c = c if i</span><span class="si">%4</span><span class="s"> else c-1
    flag_patch += chr(c - 2)
flag_patch += string[19:]

flag = flag[:19] + flag_patch[9] + flag[20:39] + 'x'
'''</span>

<span class="n">string</span> <span class="o">=</span> <span class="s">"d343igy2llogrxhkhtkr"</span>
<span class="n">flag_patch</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="p">[:</span><span class="mi">19</span><span class="p">]</span> <span class="o">+</span> <span class="n">flag_patch</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="o">+</span> <span class="s">'x'</span>
<span class="k">print</span><span class="p">(</span><span class="s">"WhiteHat{"</span> <span class="o">+</span> <span class="n">flag</span> <span class="o">+</span> <span class="s">"}"</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<h4 id="re06---100p">re06 - 100p</h4>
<blockquote>
  <p>Note: If you find flag in format WhiteHat{abcdef}, you should submit in form WhiteHat{sha1(abcdef)}</p>
</blockquote>

<p>直接打开<code class="highlighter-rouge">reverse.exe</code>, 是个key checker, 包括一个文本框和一个button
<code class="highlighter-rouge">file</code>看一下, 是个<code class="highlighter-rouge">.net</code>逆向</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file reverse.exe
reverse.exe: PE32 executable <span class="o">(</span>GUI<span class="o">)</span> Intel 80386 Mono/.Net assembly, <span class="k">for </span>MS Window           s
</code></pre></div></div>

<p>用<code class="highlighter-rouge">reflector</code>打开, 可以看到<code class="highlighter-rouge">MainWindow</code>包含一个<code class="highlighter-rouge">tb_key(TextBox)</code>和一个<code class="highlighter-rouge">btn_check(Button)</code>.
观察函数, 有一个<code class="highlighter-rouge">btn_check_Click</code>, 看起来是<code class="highlighter-rouge">button</code>对应事件:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">btn_check_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// 加密结果看起来是个base64</span>
    <span class="k">if</span> <span class="p">(</span><span class="nf">Enc</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">tb_key</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="m">0x23c5</span><span class="p">,</span> <span class="m">0xa09d</span><span class="p">)</span> <span class="p">==</span> <span class="s">"iB6WcuCG3nq+fZkoGgneegMtA5SRRL9yH0vUeN56FgbikZFE1HhTM9R4tZPghhYGFgbUeHB4tEKRRNR4Ymu0OwljQwmRRNR4jWBweOKRRyCRRAljLGQ="</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"Correct!! You found FLAG"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">"Try again!"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>程序没坑, 把<code class="highlighter-rouge">Enc</code>函数逆向就可以得到输入的key.
其他函数:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Enc</span><span class="p">(</span><span class="kt">string</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">e</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">num</span><span class="p">;</span>
    <span class="kt">int</span><span class="p">[]</span> <span class="n">numArray</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="n">s</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>
    <span class="c1">// numArray is s</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">num</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">num</span> <span class="p">&lt;</span> <span class="n">s</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">num</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">numArray</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="p">=</span> <span class="n">s</span><span class="p">[</span><span class="n">num</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="kt">int</span><span class="p">[]</span> <span class="n">numArray2</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="n">numArray</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>
    <span class="c1">// 用e和n对输入字符串的每一位应用mod函数</span>
    <span class="c1">// 结果是1字节变2字节, 注意字节序</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">num</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">num</span> <span class="p">&lt;</span> <span class="n">numArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">num</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">numArray2</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="p">=</span> <span class="nf">mod</span><span class="p">(</span><span class="n">numArray</span><span class="p">[</span><span class="n">num</span><span class="p">],</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">string</span> <span class="n">str</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">num</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">num</span> <span class="p">&lt;</span> <span class="n">numArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">num</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="n">str</span> <span class="p">=</span> <span class="n">str</span> <span class="p">+</span> <span class="p">((</span><span class="kt">char</span><span class="p">)</span> <span class="n">numArray2</span><span class="p">[</span><span class="n">num</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="c1">// 然后convert to base64 string</span>
    <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToBase64String</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Unicode</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">str</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 这个函数可以不用管具体细节</span>
<span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">mod</span><span class="p">(</span><span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="kt">int</span> <span class="n">e</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span><span class="p">[]</span> <span class="n">numArray</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="m">100</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">index</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="c1">// numArray是e的二进制形式</span>
    <span class="k">do</span>
    <span class="p">{</span>
        <span class="n">numArray</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">=</span> <span class="n">e</span> <span class="p">%</span> <span class="m">2</span><span class="p">;</span>
        <span class="n">index</span><span class="p">++;</span>
        <span class="n">e</span> <span class="p">/=</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">e</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">num2</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">index</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">--)</span>
    <span class="p">{</span>
        <span class="n">num2</span> <span class="p">=</span> <span class="p">(</span><span class="n">num2</span> <span class="p">*</span> <span class="n">num2</span><span class="p">)</span> <span class="p">%</span> <span class="n">n</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">numArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">num2</span> <span class="p">=</span> <span class="p">(</span><span class="n">num2</span> <span class="p">*</span> <span class="n">m</span><span class="p">)</span> <span class="p">%</span> <span class="n">n</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">num2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>脚本:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">hashlib</span>

<span class="c"># 这里就是用python重写了一下上面的mod函数</span>
<span class="k">def</span> <span class="nf">mod</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">numArray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">numArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> 
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">e</span> <span class="o">//=</span> <span class="mi">2</span>
    <span class="n">num2</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">num2</span> <span class="o">=</span> <span class="p">(</span><span class="n">num2</span> <span class="o">*</span> <span class="n">num2</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
        <span class="k">if</span> <span class="n">numArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">num2</span> <span class="o">=</span> <span class="p">(</span><span class="n">num2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
    <span class="k">return</span> <span class="nb">hex</span><span class="p">(</span><span class="n">num2</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c"># 这里需要补足4位</span>

<span class="c"># 爆破字典</span>
<span class="n">dicts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">'0'</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s">'}'</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mh">0x23c5</span><span class="p">,</span> <span class="mh">0xa09d</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mh">0x23c5</span><span class="p">,</span> <span class="mh">0xa09d</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="c"># little-endian, 小端存储,所以需要把字节顺序颠倒一下</span>
    <span class="c"># mod后的两个字节对应原始输入的一个字节</span>
    <span class="n">dicts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">enc</span> <span class="o">=</span> <span class="s">"iB6WcuCG3nq+fZkoGgneegMtA5SRRL9yH0vUeN56FgbikZFE1HhTM9R4tZPghhYGFgbUeHB4tEKRRNR4Ymu0OwljQwmRRNR4jWBweOKRRyCRRAljLGQ="</span>
<span class="c"># base64解码, 因为解码出来的字节有些没有字符表示, 所以用hex表示</span>
<span class="n">dec</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span><span class="o">.</span><span class="nb">hex</span><span class="p">()</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s">''</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dec</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="n">dicts</span><span class="p">[</span><span class="n">dec</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]]</span>
<span class="c"># flag: WhiteHat{N3xT_t1m3_I_wi11_Us3_l4rg3_nUmb3r}</span>
<span class="c"># 以SHA-1方式提交flag</span>
<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>


    </div>

    <!-- Start Related article -->

    
        
        
        
        
          <section class="ampstart-related-article-section p3 mb4 border-top">
              <h2 class="ampstart-heading ampstart-label m0 mb3">Related article</h2>
                <article class="ampstart-related-article">
                    
                        
                        <amp-img src="/assets/images/radhakrishna.jpg" width="656" height="350" layout="responsive" alt="" class="mb3"></amp-img>
                        
                    
                    
                    
                      
                        
                          
                          
                            <h3 class="ampstart-heading h4 m0 mb3"><b>tjctf 2018 WP</b></h3>
                            <p class="line-height-4 mb3">
                            
                              #### Validator(30p) > I found a flag validation program. Do what you want with it....
                            
                            </p>
                            <a href="/tjctf-2018-rev-wp-part" class="ampstart-rekated-article-readmore block text-decoration-none ampstart-label">Read more</a>
                          
                        
                      
                    
                      
                    
                      
                        
                          
                          
                            <h3 class="ampstart-heading h4 m0 mb3"><b>护网杯 2018 rerere WP</b></h3>
                            <p class="line-height-4 mb3">
                            
                              比较烦的一道题 先运行看看： D:\CTF\CTFs\huwangbei\rerere>.\task_huwang-refinal-7.exe .\task_huwang-refinal-7.exe hash D:\CTF\CTFs\huwangbei\rerere>.\task_huwang-refinal-7.exe 12346 No! You are Wrong 需要在命令行传入一个hash值。 用IDA打开，找到引用字符串`No! You are...
                            
                            </p>
                            <a href="/huwangbei-2018-rerere-WP" class="ampstart-rekated-article-readmore block text-decoration-none ampstart-label">Read more</a>
                          
                        
                      
                    
                      
                        
                      
                    
                      
                        
                          
                          
                            <h3 class="ampstart-heading h4 m0 mb3"><b>ISITDTU CTF 2018 WP</b></h3>
                            <p class="line-height-4 mb3">
                            
                              Cool (3rd) ELF 64-bit executable 运行./cool提示缺少共享库 于是直接丢到IDA里 可以找到几个关键字符串： "Give me your key: " "Wrong~" "Congratulation~~~"...
                            
                            </p>
                            <a href="/ISITDTU-CTF-2018-Reverse-writeup-part" class="ampstart-rekated-article-readmore block text-decoration-none ampstart-label">Read more</a>
                          
                        
                      
                    
                      
                    
                </article>
          </section>
        
    
    <!-- End Related article -->
<hr>


  

  


<!-- Start Socialbox -->
<div class="ampstart-social-box mb4">
  <amp-social-share type="twitter" aria-label="Share this on Twitter"></amp-social-share>
  <amp-social-share type="facebook" aria-label="Share this on Facebook" data-param-app_id="145393166088568"></amp-social-share>
  <amp-social-share type="gplus" aria-label="Share this on Google Plus"></amp-social-share>
  <amp-social-share type="email" aria-label="Share this with E-mail"></amp-social-share>
</div>
<!-- End Socialbox -->


  <footer class="ampstart-footer flex flex-column items-center px3">
    <ul class="ampstart-social-follow list-reset flex justify-around items-center flex-wrap m0 mb4">
        

        <li>
            <a href="https://twitter.com/twitter" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="22.2" viewbox="0 0 53 49">
                    <title>Twitter</title>
                    <path d="M45 6.9c-1.6 1-3.3 1.6-5.2 2-1.5-1.6-3.6-2.6-5.9-2.6-4.5 0-8.2 3.7-8.2 8.3 0 .6.1 1.3.2 1.9-6.8-.4-12.8-3.7-16.8-8.7C8.4 9 8 10.5 8 12c0 2.8 1.4 5.4 3.6 6.9-1.3-.1-2.6-.5-3.7-1.1v.1c0 4 2.8 7.4 6.6 8.1-.7.2-1.5.3-2.2.3-.5 0-1 0-1.5-.1 1 3.3 4 5.7 7.6 5.7-2.8 2.2-6.3 3.6-10.2 3.6-.6 0-1.3-.1-1.9-.1 3.6 2.3 7.9 3.7 12.5 3.7 15.1 0 23.3-12.6 23.3-23.6 0-.3 0-.7-.1-1 1.6-1.2 3-2.7 4.1-4.3-1.4.6-3 1.1-4.7 1.3 1.7-1 3-2.7 3.6-4.6" class="ampstart-icon ampstart-icon-twitter"></path>
                </svg>
            </a>
        </li>
         

        <li>
            <a href="https://facebook.com/facebook" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Facebook">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="23.6" viewbox="0 0 56 55">
                    <title>Facebook</title>
                    <path d="M47.5 43c0 1.2-.9 2.1-2.1 2.1h-10V30h5.1l.8-5.9h-5.9v-3.7c0-1.7.5-2.9 3-2.9h3.1v-5.3c-.6 0-2.4-.2-4.6-.2-4.5 0-7.5 2.7-7.5 7.8v4.3h-5.1V30h5.1v15.1H10.7c-1.2 0-2.2-.9-2.2-2.1V8.3c0-1.2 1-2.2 2.2-2.2h34.7c1.2 0 2.1 1 2.1 2.2V43" class="ampstart-icon ampstart-icon-fb"></path>
                </svg>
            </a>
        </li>
         

        <li>
            <a href="https://github.com/github" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML github">
                <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 64 64">
                    <path d="M22.4 1.4C-.8 9-7.4 38.4 10.5 54.9 14.7 58.8 20.4 62 23 62c.5 0 1-1.6 1-3.5 0-3.3-.2-3.5-3.5-3.5-3.5 0-4.2-.5-9-6.6-4.4-5.6-2.3-6.2 3.2-.9 4.2 4 7.5 4.5 9.8 1.2 1.4-2.1 1.4-2.2-.7-3-6-2.3-8.8-4.2-10.2-7.2-2.1-4.3-2.1-12.4 0-15.3.8-1.2 1.2-2.7.9-3.2-1-1.6.5-7 1.8-7 .7 0 2.4.6 3.8 1.4 1.7.9 6 1.4 11.9 1.4s10.2-.5 11.9-1.4c1.4-.8 3.1-1.4 3.8-1.4 1.3 0 2.8 5.4 1.8 7-.3.5.1 2 .9 3.2 1.8 2.5 2.1 10.3.7 14.1-1.4 3.6-5 6.6-9.3 7.8-3.3.9-3.7 1.2-2.8 2.9.5 1 1 4.6 1 7.9 0 3.5.4 6.1 1 6.1 5.2 0 15.8-8.8 19.8-16.5 2.3-4.3 2.7-6.3 2.7-13.5 0-7-.4-9.4-2.4-13.5C57.9 12.2 51.8 6 45.6 3 39.6.2 28.5-.6 22.4 1.4z" class="ampstart-icon ampstart-icon-github" />
                </svg>
            </a>
        </li>
        

    </ul>
    <nav class="ampstart-footer-nav">
        <ul class="list-reset flex flex-wrap mb3">
            

            <li class="px1">
                <a class="text-decoration-none ampstart-label" href="/about">About</a>
            </li>
             

            <li class="px1">
                <a class="text-decoration-none ampstart-label" href="/contact">Contact</a>
            </li>
             

            <li class="px1">
                <a class="text-decoration-none ampstart-label" href="/privacy-policy">Privacy Policy</a>
            </li>
            

        </ul>
    </nav>
    <small>
        &copy; 2017
    <a href="/"></a> &nbsp; | &nbsp;  All Rights Reserved.

    </small>
    <small>
      Published with <a href="https://jekyllrb.com/">Jekyll</a>
      using <a href="https://github.com/samanyougarg/hanuman">Hanuman</a>
    </small>
</footer>


</main>


    
  </body>
</html>
